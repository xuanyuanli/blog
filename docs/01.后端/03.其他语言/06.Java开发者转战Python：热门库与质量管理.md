---
title: Javaå¼€å‘è€…è½¬æˆ˜Pythonï¼šçƒ­é—¨åº“ä¸è´¨é‡ç®¡ç†
date: 2025-01-30 21:10:00
permalink: /pages/python-for-java-dev-package/
categories:
  - åç«¯
  - å…¶ä»–è¯­è¨€
tags:
  - Python
author:
  name: è½©è¾•æ
  link: https://github.com/xuanyuanli
---

**ğŸ“– ç³»åˆ—æ–‡ç« å¯¼èˆª**

æœ¬æ–‡æ˜¯"Javaå¼€å‘è€…è½¬æˆ˜Python"ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡ï¼ˆå®Œç»“ç¯‡ï¼‰ï¼Œä»‹ç»Pythonç”Ÿæ€ç³»ç»Ÿå’Œä»£ç è´¨é‡ç®¡ç†ã€‚

ğŸ“š **ç³»åˆ—å›é¡¾**ï¼š
- [åŸºç¡€ç¯‡](/pages/python-for-java-dev-base/) - PythonåŸºç¡€è¯­æ³•ã€æ•°æ®ç»“æ„ã€é¢å‘å¯¹è±¡
- [è¿›é˜¶ç¯‡](/pages/python-for-java-dev-raise/) - å¼‚å¸¸å¤„ç†ã€æ–‡ä»¶æ“ä½œã€è£…é¥°å™¨ã€å¼‚æ­¥ç¼–ç¨‹

---

## ä¸€ã€Pythonç”Ÿæ€ä¸çƒ­é—¨åº“

Pythonæ‹¥æœ‰ä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“ç”Ÿæ€,è¿™æ˜¯å…¶å—æ¬¢è¿çš„é‡è¦åŸå› ã€‚ä½œä¸ºJavaå¼€å‘è€…,ä½ ä¼šå‘ç°Pythonçš„åº“ç”Ÿæ€æ›´åŠ å¼€æ”¾å’Œå¤šæ ·åŒ–ã€‚

### 1ã€æ•°æ®ç§‘å­¦

#### 1.1ã€- æ•°å€¼è®¡ç®—åŸºç¡€

NumPyæ˜¯Pythonç§‘å­¦è®¡ç®—çš„åŸºç¡€åº“,æä¾›é«˜æ€§èƒ½çš„å¤šç»´æ•°ç»„å¯¹è±¡å’Œç›¸å…³å·¥å…·ã€‚ç±»ä¼¼Javaçš„æ•°å­¦åº“,ä½†åŠŸèƒ½æ›´å¼ºå¤§ã€‚

```python
import numpy as np

# åˆ›å»ºæ•°ç»„ - ç±»ä¼¼Javaçš„int[]æ•°ç»„,ä½†åŠŸèƒ½æ›´å¼º
arr = np.array([1, 2, 3, 4, 5])  # ä¸€ç»´æ•°ç»„
matrix = np.array([[1, 2], [3, 4]])  # äºŒç»´æ•°ç»„(çŸ©é˜µ)

# æ•°ç»„è¿ç®— - å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œè¿ç®—,æ— éœ€å¾ªç¯
result = arr * 2  # æ¯ä¸ªå…ƒç´ éƒ½ä¹˜ä»¥2: [2, 4, 6, 8, 10]
# Javaéœ€è¦å¾ªç¯: for(int i=0; i<arr.length; i++) arr[i] *= 2;

# çŸ©é˜µä¹˜æ³• - dotè¡¨ç¤ºç‚¹ç§¯/çŸ©é˜µä¹˜æ³•
dot_product = np.dot(matrix, matrix)
# ç»“æœ: [[7, 10], [15, 22]]
# è®¡ç®—è¿‡ç¨‹: [1*1+2*3, 1*2+2*4; 3*1+4*3, 3*2+4*4]

# å¸¸ç”¨ç»Ÿè®¡å‡½æ•°
print(np.mean(arr))  # å¹³å‡å€¼: (1+2+3+4+5)/5 = 3.0
print(np.sum(arr))   # æ±‚å’Œ: 1+2+3+4+5 = 15
print(np.max(arr))   # æœ€å¤§å€¼: 5
print(np.min(arr))   # æœ€å°å€¼: 1
print(np.std(arr))   # æ ‡å‡†å·®: è¡¡é‡æ•°æ®åˆ†æ•£ç¨‹åº¦

# æ•°ç»„å½¢çŠ¶æ“ä½œ
print(matrix.shape)   # è¾“å‡º: (2, 2) è¡¨ç¤º2è¡Œ2åˆ—
reshaped = arr.reshape(5, 1)  # é‡å¡‘ä¸º5è¡Œ1åˆ—
```

#### 1.2ã€- æ•°æ®åˆ†æ

Pandasæ˜¯æ•°æ®åˆ†æçš„æ ¸å¿ƒåº“,æä¾›DataFrameç­‰æ•°æ®ç»“æ„,ç±»ä¼¼äºExcelæˆ–æ•°æ®åº“è¡¨çš„æ“ä½œã€‚

```python
import pandas as pd

# åˆ›å»ºDataFrame - ç±»ä¼¼æ•°æ®åº“è¡¨æˆ–Excelè¡¨æ ¼
df = pd.DataFrame({
    'name': ['Alice', 'Bob', 'Charlie'],     # å§“ååˆ—
    'age': [25, 30, 35],                     # å¹´é¾„åˆ—
    'city': ['Beijing', 'Shanghai', 'Guangzhou']  # åŸå¸‚åˆ—
})

# æ•°æ®æŸ¥çœ‹æ“ä½œ
print(df.head())      # æŸ¥çœ‹å‰5è¡Œæ•°æ®(é»˜è®¤5è¡Œ)
print(df.tail(2))     # æŸ¥çœ‹å2è¡Œæ•°æ®
print(df.info())      # æŸ¥çœ‹æ•°æ®ç»“æ„ä¿¡æ¯(åˆ—åã€æ•°æ®ç±»å‹ã€éç©ºå€¼æ•°é‡)
print(df.describe())  # ç»Ÿè®¡æè¿°(countã€meanã€stdã€minã€maxç­‰)

# æ•°æ®ç­›é€‰ - ç±»ä¼¼SQLçš„WHEREå­å¥
filtered = df[df['age'] > 25]  # ç­›é€‰å¹´é¾„å¤§äº25çš„è®°å½•
adults = df[df['age'] >= 30]   # ç­›é€‰å¹´é¾„å¤§äºç­‰äº30çš„è®°å½•

# åˆ—æ“ä½œ
print(df['name'])           # è·å–å•åˆ—
print(df[['name', 'age']])  # è·å–å¤šåˆ—
df['salary'] = [8000, 10000, 12000]  # æ·»åŠ æ–°åˆ—

# æ–‡ä»¶è¯»å†™ - æ”¯æŒå¤šç§æ ¼å¼
df.to_csv('data.csv', index=False)  # ä¿å­˜ä¸ºCSVæ–‡ä»¶,ä¸ä¿å­˜è¡Œç´¢å¼•
df = pd.read_csv('data.csv')         # ä»CSVæ–‡ä»¶è¯»å–æ•°æ®
# ä¹Ÿæ”¯æŒ: read_excel(), read_json(), read_sql() ç­‰
```

#### 1.3ã€- æ•°æ®å¯è§†åŒ–

Matplotlibæ˜¯Pythonçš„2Dç»˜å›¾åº“,ç”¨äºåˆ›å»ºå„ç§é™æ€ã€åŠ¨æ€å’Œäº¤äº’å¼å›¾è¡¨ã€‚

```python
import matplotlib.pyplot as plt

# å‡†å¤‡æ•°æ®
x = [1, 2, 3, 4, 5]      # Xè½´æ•°æ®ç‚¹
y = [2, 4, 6, 8, 10]     # Yè½´æ•°æ®ç‚¹

# åˆ›å»ºæŠ˜çº¿å›¾
plt.figure(figsize=(8, 6))  # è®¾ç½®å›¾å½¢å¤§å°(å®½8è‹±å¯¸,é«˜6è‹±å¯¸)
plt.plot(x, y, marker='o', linestyle='-', color='blue')  # ç»˜åˆ¶å¸¦åœ†ç‚¹æ ‡è®°çš„è“è‰²çº¿
plt.xlabel('Xè½´æ ‡ç­¾')        # è®¾ç½®Xè½´æ ‡ç­¾
plt.ylabel('Yè½´æ ‡ç­¾')        # è®¾ç½®Yè½´æ ‡ç­¾
plt.title('ç®€å•æŠ˜çº¿å›¾')      # è®¾ç½®å›¾è¡¨æ ‡é¢˜
plt.grid(True)              # æ˜¾ç¤ºç½‘æ ¼çº¿
plt.show()                  # æ˜¾ç¤ºå›¾è¡¨

# åˆ›å»ºæŸ±çŠ¶å›¾
categories = ['A', 'B', 'C']  # ç±»åˆ«åç§°
values = [10, 20, 15]         # å¯¹åº”çš„å€¼
plt.figure(figsize=(6, 4))
plt.bar(categories, values, color=['red', 'green', 'blue'])  # ä¸åŒé¢œè‰²çš„æŸ±å­
plt.ylabel('æ•°å€¼')
plt.title('æŸ±çŠ¶å›¾ç¤ºä¾‹')
plt.show()

# åˆ›å»ºå­å›¾ - åœ¨ä¸€ä¸ªçª—å£æ˜¾ç¤ºå¤šä¸ªå›¾è¡¨
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 4))  # 1è¡Œ2åˆ—çš„å­å›¾
ax1.plot(x, y)          # ç¬¬ä¸€ä¸ªå­å›¾
ax1.set_title('æŠ˜çº¿å›¾')
ax2.bar(categories, values)  # ç¬¬äºŒä¸ªå­å›¾
ax2.set_title('æŸ±çŠ¶å›¾')
plt.tight_layout()      # è‡ªåŠ¨è°ƒæ•´å­å›¾é—´è·
plt.show()
```

#### 1.4ã€- ç§‘å­¦è®¡ç®—

SciPyæ„å»ºåœ¨NumPyä¹‹ä¸Š,æä¾›æ›´å¤šç§‘å­¦è®¡ç®—åŠŸèƒ½,åŒ…æ‹¬ç»Ÿè®¡ã€ä¼˜åŒ–ã€ä¿¡å·å¤„ç†ç­‰ã€‚

```python
from scipy import stats, optimize
import numpy as np

# ç»Ÿè®¡åˆ†æ
data = [1, 2, 3, 4, 5, 3, 4, 2, 3, 4]

# æ­£æ€åˆ†å¸ƒæ‹Ÿåˆ - ä¼°è®¡æ•°æ®çš„æ­£æ€åˆ†å¸ƒå‚æ•°
mean, std = stats.norm.fit(data)  # æ‹Ÿåˆæ­£æ€åˆ†å¸ƒ,å¾—åˆ°å‡å€¼å’Œæ ‡å‡†å·®
print(f"ä¼°è®¡å‡å€¼: {mean:.2f}, ä¼°è®¡æ ‡å‡†å·®: {std:.2f}")

# å‡è®¾æ£€éªŒ - æ£€éªŒæ•°æ®æ˜¯å¦ç¬¦åˆæ­£æ€åˆ†å¸ƒ
statistic, p_value = stats.normaltest(data)  # æ­£æ€æ€§æ£€éªŒ
print(f"æ­£æ€æ£€éªŒpå€¼: {p_value:.4f}")  # på€¼>0.05é€šå¸¸è®¤ä¸ºç¬¦åˆæ­£æ€åˆ†å¸ƒ

# æ•°å€¼ä¼˜åŒ– - å¯»æ‰¾å‡½æ•°çš„æœ€å°å€¼
def objective_function(x):
    """ç›®æ ‡å‡½æ•°: y = xÂ² + 2x + 1"""
    return x**2 + 2*x + 1

# å¯»æ‰¾å‡½æ•°æœ€å°å€¼ç‚¹
result = optimize.minimize(objective_function, x0=0)  # x0=0æ˜¯åˆå§‹çŒœæµ‹å€¼
print(f"æœ€å°å€¼ç‚¹: x = {result.x[0]:.4f}")  # ç†è®ºå€¼åº”è¯¥æ˜¯x=-1
print(f"æœ€å°å€¼: y = {result.fun:.4f}")     # å¯¹åº”çš„å‡½æ•°å€¼

# æ±‚è§£æ–¹ç¨‹ - æ‰¾åˆ°å‡½æ•°çš„é›¶ç‚¹
def equation(x):
    """æ–¹ç¨‹: xÂ² - 4 = 0"""
    return x**2 - 4

# å¯»æ‰¾æ–¹ç¨‹çš„æ ¹
root = optimize.fsolve(equation, 1)[0]  # ä»x=1å¼€å§‹æœç´¢
print(f"æ–¹ç¨‹xÂ²-4=0çš„è§£: x = {root:.4f}")  # åº”è¯¥å¾—åˆ°x=2
```

### 2ã€Webå¼€å‘æ¡†æ¶

#### 2.1ã€- è½»é‡çº§æ¡†æ¶

Flaskæ˜¯ä¸€ä¸ªè½»é‡çº§çš„Webæ¡†æ¶,ç®€å•çµæ´»,é€‚åˆå°åˆ°ä¸­å‹é¡¹ç›®ã€‚ç±»ä¼¼Spring Bootä½†æ›´ç®€æ´ã€‚

```python
from flask import Flask, request, jsonify

# åˆ›å»ºFlaskåº”ç”¨å®ä¾‹ - ç±»ä¼¼Spring Bootçš„@SpringBootApplication
app = Flask(__name__)

# å®šä¹‰è·¯ç”± - ç±»ä¼¼Springçš„@RequestMapping
@app.route('/')  # å¤„ç†æ ¹è·¯å¾„ "/"
def hello():
    """å¤„ç†GETè¯·æ±‚åˆ°æ ¹è·¯å¾„"""
    return 'Hello World!'  # ç›´æ¥è¿”å›å­—ç¬¦ä¸²

# æ”¯æŒå¤šç§HTTPæ–¹æ³•çš„è·¯ç”±
@app.route('/api/users', methods=['GET', 'POST'])  # æŒ‡å®šæ”¯æŒçš„HTTPæ–¹æ³•
def users():
    """ç”¨æˆ·APIç«¯ç‚¹ - æ ¹æ®è¯·æ±‚æ–¹æ³•æ‰§è¡Œä¸åŒé€»è¾‘"""
    if request.method == 'GET':
        # å¤„ç†GETè¯·æ±‚ - è·å–ç”¨æˆ·åˆ—è¡¨
        return jsonify({'users': []})  # jsonify()å°†å­—å…¸è½¬ä¸ºJSONå“åº”
    elif request.method == 'POST':
        # å¤„ç†POSTè¯·æ±‚ - åˆ›å»ºæ–°ç”¨æˆ·
        user_data = request.get_json()  # è·å–è¯·æ±‚ä½“ä¸­çš„JSONæ•°æ®
        # è¿™é‡Œå¯ä»¥æ·»åŠ ç”¨æˆ·åˆ›å»ºé€»è¾‘
        return jsonify({'status': 'created', 'user': user_data})

# å¸¦å‚æ•°çš„è·¯ç”± - ç±»ä¼¼Springçš„@PathVariable
@app.route('/users/<int:user_id>')  # <int:user_id>è¡¨ç¤ºæ•´æ•°ç±»å‹çš„è·¯å¾„å‚æ•°
def get_user(user_id):
    """æ ¹æ®ç”¨æˆ·IDè·å–ç”¨æˆ·ä¿¡æ¯"""
    return jsonify({'id': user_id, 'name': f'User {user_id}'})

# æŸ¥è¯¢å‚æ•°ç¤ºä¾‹
@app.route('/search')
def search():
    """å¤„ç†æŸ¥è¯¢å‚æ•° - ç±»ä¼¼Springçš„@RequestParam"""
    query = request.args.get('q', '')  # è·å–æŸ¥è¯¢å‚æ•°q,é»˜è®¤ç©ºå­—ç¬¦ä¸²
    page = request.args.get('page', 1, type=int)  # è·å–pageå‚æ•°,é»˜è®¤1,è½¬ä¸ºint
    return jsonify({'query': query, 'page': page})

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)  # debug=Trueå¯ç”¨è°ƒè¯•æ¨¡å¼
    # è®¿é—® http://localhost:5000 æŸ¥çœ‹æ•ˆæœ
```

#### 2.2ã€- å…¨æ ˆæ¡†æ¶

Djangoæ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„Webæ¡†æ¶,å†…ç½®ORMã€ç®¡ç†åå°ã€ç”¨æˆ·è®¤è¯ç­‰,é€‚åˆå¤§å‹é¡¹ç›®ã€‚æ›´ç±»ä¼¼Springå…¨å®¶æ¡¶ã€‚

```python
# Djangoé¡¹ç›®ç»“æ„ç±»ä¼¼Spring Boot:
# myproject/
#   â”œâ”€â”€ manage.py          # é¡¹ç›®ç®¡ç†è„šæœ¬(ç±»ä¼¼mvn spring-boot:run)
#   â”œâ”€â”€ myproject/
#   â”‚   â”œâ”€â”€ settings.py    # é¡¹ç›®é…ç½®(ç±»ä¼¼application.properties)
#   â”‚   â”œâ”€â”€ urls.py        # å…¨å±€URLé…ç½®
#   â”‚   â””â”€â”€ wsgi.py        # WSGIé…ç½®
#   â””â”€â”€ myapp/
#       â”œâ”€â”€ models.py      # æ•°æ®æ¨¡å‹(ç±»ä¼¼JPA Entity)
#       â”œâ”€â”€ views.py       # è§†å›¾å‡½æ•°(ç±»ä¼¼Controller)
#       â”œâ”€â”€ urls.py        # åº”ç”¨URLé…ç½®
#       â””â”€â”€ admin.py       # ç®¡ç†åå°é…ç½®

# models.py - å®šä¹‰æ•°æ®æ¨¡å‹
from django.db import models

class User(models.Model):
    """ç”¨æˆ·æ¨¡å‹ - ç±»ä¼¼JPAçš„@Entity"""
    # Djangoè‡ªåŠ¨åˆ›å»ºidä¸»é”®,æ— éœ€æ‰‹åŠ¨å®šä¹‰
    name = models.CharField(max_length=100)  # VARCHAR(100)å­—æ®µ
    email = models.EmailField()              # EMAILå­—æ®µ,è‡ªåŠ¨éªŒè¯æ ¼å¼
    created_at = models.DateTimeField(auto_now_add=True)  # åˆ›å»ºæ—¶è‡ªåŠ¨è®¾ç½®
    updated_at = models.DateTimeField(auto_now=True)      # æ›´æ–°æ—¶è‡ªåŠ¨è®¾ç½®
    is_active = models.BooleanField(default=True)         # å¸ƒå°”å­—æ®µ,é»˜è®¤å€¼

    class Meta:
        db_table = 'users'        # æŒ‡å®šè¡¨å
        ordering = ['-created_at'] # é»˜è®¤æŒ‰åˆ›å»ºæ—¶é—´å€’åº

    def __str__(self):
        """å­—ç¬¦ä¸²è¡¨ç¤º - ç±»ä¼¼Javaçš„toString()"""
        return self.name

# views.py - è§†å›¾å‡½æ•°
from django.http import JsonResponse
from django.shortcuts import get_object_or_404  # 404å¤„ç†
from django.views.decorators.csrf import csrf_exempt  # CSRFä¿æŠ¤
import json

def user_list(request):
    """ç”¨æˆ·åˆ—è¡¨API - ç±»ä¼¼Springçš„@GetMapping"""
    if request.method == 'GET':
        users = User.objects.all()  # æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·,ç±»ä¼¼JPAçš„findAll()
        data = {
            'users': list(users.values('id', 'name', 'email'))  # è½¬ä¸ºå­—å…¸åˆ—è¡¨
        }
        return JsonResponse(data)

@csrf_exempt  # ç¦ç”¨CSRFæ£€æŸ¥(ä»…ç”¨äºAPI)
def user_create(request):
    """åˆ›å»ºç”¨æˆ·API - ç±»ä¼¼Springçš„@PostMapping"""
    if request.method == 'POST':
        data = json.loads(request.body)  # è§£æJSONè¯·æ±‚ä½“
        user = User.objects.create(      # åˆ›å»ºå¹¶ä¿å­˜ç”¨æˆ·
            name=data['name'],
            email=data['email']
        )
        return JsonResponse({'id': user.id, 'status': 'created'})

def user_detail(request, user_id):
    """ç”¨æˆ·è¯¦æƒ…API - ç±»ä¼¼Springçš„@PathVariable"""
    user = get_object_or_404(User, id=user_id)  # æŸ¥è¯¢ç”¨æˆ·,ä¸å­˜åœ¨åˆ™è¿”å›404
    return JsonResponse({
        'id': user.id,
        'name': user.name,
        'email': user.email,
        'created_at': user.created_at.isoformat()
    })

# urls.py - URLé…ç½®
from django.urls import path
from . import views

urlpatterns = [
    path('users/', views.user_list, name='user_list'),           # GET /users/
    path('users/create/', views.user_create, name='user_create'), # POST /users/create/
    path('users/<int:user_id>/', views.user_detail, name='user_detail'), # GET /users/1/
]
```

#### 2.3ã€- ç°ä»£å¼‚æ­¥æ¡†æ¶

FastAPIæ˜¯ç°ä»£çš„å¼‚æ­¥Webæ¡†æ¶,è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£,æ€§èƒ½ä¼˜å¼‚,ç±»ä¼¼Spring WebFluxã€‚

```python
from fastapi import FastAPI, HTTPException, Query, Path
from pydantic import BaseModel, EmailStr  # æ•°æ®éªŒè¯åº“
from typing import Optional, List
import asyncio

# åˆ›å»ºFastAPIåº”ç”¨
app = FastAPI(
    title="ç”¨æˆ·ç®¡ç†API",           # APIæ–‡æ¡£æ ‡é¢˜
    description="ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ",     # APIæè¿°
    version="1.0.0"              # ç‰ˆæœ¬å·
)

# å®šä¹‰æ•°æ®æ¨¡å‹ - ç±»ä¼¼Springçš„DTO,è‡ªåŠ¨éªŒè¯
class User(BaseModel):
    """ç”¨æˆ·æ•°æ®æ¨¡å‹"""
    name: str                    # å¿…å¡«å­—ç¬¦ä¸²å­—æ®µ
    age: int                     # å¿…å¡«æ•´æ•°å­—æ®µ
    email: EmailStr              # é‚®ç®±æ ¼å¼éªŒè¯
    is_active: bool = True       # å¯é€‰å­—æ®µ,é»˜è®¤True

class UserResponse(BaseModel):
    """ç”¨æˆ·å“åº”æ¨¡å‹"""
    id: int
    name: str
    age: int
    email: str
    is_active: bool

# æ¨¡æ‹Ÿæ•°æ®åº“
fake_db = []
next_id = 1

# æ ¹è·¯å¾„ - å¼‚æ­¥å‡½æ•°
@app.get("/")
async def root():
    """æ ¹è·¯å¾„å¤„ç†å™¨"""
    return {"message": "æ¬¢è¿ä½¿ç”¨ç”¨æˆ·ç®¡ç†API"}

# åˆ›å»ºç”¨æˆ· - è‡ªåŠ¨JSONè§£æå’ŒéªŒè¯
@app.post("/users/", response_model=UserResponse, status_code=201)
async def create_user(user: User):
    """
    åˆ›å»ºæ–°ç”¨æˆ·

    - **name**: ç”¨æˆ·å§“å
    - **age**: ç”¨æˆ·å¹´é¾„
    - **email**: ç”¨æˆ·é‚®ç®±
    - **is_active**: æ˜¯å¦æ¿€æ´»(å¯é€‰)
    """
    global next_id
    user_dict = user.dict()  # è½¬ä¸ºå­—å…¸
    user_dict["id"] = next_id
    fake_db.append(user_dict)
    next_id += 1
    return user_dict

# è·å–ç”¨æˆ·åˆ—è¡¨ - æ”¯æŒåˆ†é¡µå’Œè¿‡æ»¤
@app.get("/users/", response_model=List[UserResponse])
async def get_users(
    skip: int = Query(0, ge=0, description="è·³è¿‡è®°å½•æ•°"),        # æŸ¥è¯¢å‚æ•°,>=0
    limit: int = Query(10, ge=1, le=100, description="è¿”å›è®°å½•æ•°"),  # é™åˆ¶1-100
    active_only: Optional[bool] = Query(None, description="åªè¿”å›æ¿€æ´»ç”¨æˆ·")
):
    """è·å–ç”¨æˆ·åˆ—è¡¨,æ”¯æŒåˆ†é¡µ"""
    users = fake_db[skip:skip + limit]  # æ¨¡æ‹Ÿåˆ†é¡µ
    if active_only is not None:
        users = [u for u in users if u["is_active"] == active_only]
    return users

# è·å–å•ä¸ªç”¨æˆ· - è·¯å¾„å‚æ•°éªŒè¯
@app.get("/users/{user_id}", response_model=UserResponse)
async def get_user(
    user_id: int = Path(..., gt=0, description="ç”¨æˆ·ID,å¿…é¡»å¤§äº0")  # è·¯å¾„å‚æ•°éªŒè¯
):
    """æ ¹æ®IDè·å–ç”¨æˆ·"""
    user = next((u for u in fake_db if u["id"] == user_id), None)
    if not user:
        raise HTTPException(status_code=404, detail="ç”¨æˆ·ä¸å­˜åœ¨")  # æŠ›å‡ºHTTPå¼‚å¸¸
    return user

# æ›´æ–°ç”¨æˆ· - éƒ¨åˆ†æ›´æ–°
@app.patch("/users/{user_id}", response_model=UserResponse)
async def update_user(
    user_id: int,
    user_update: dict  # æ¥å—ä»»æ„å­—æ®µçš„å­—å…¸
):
    """æ›´æ–°ç”¨æˆ·ä¿¡æ¯"""
    user = next((u for u in fake_db if u["id"] == user_id), None)
    if not user:
        raise HTTPException(status_code=404, detail="ç”¨æˆ·ä¸å­˜åœ¨")

    # æ›´æ–°å­—æ®µ
    for key, value in user_update.items():
        if key in user:
            user[key] = value

    return user

# åˆ é™¤ç”¨æˆ·
@app.delete("/users/{user_id}")
async def delete_user(user_id: int):
    """åˆ é™¤ç”¨æˆ·"""
    global fake_db
    fake_db = [u for u in fake_db if u["id"] != user_id]
    return {"message": "ç”¨æˆ·å·²åˆ é™¤"}

# å¼‚æ­¥æ“ä½œç¤ºä¾‹
@app.get("/users/{user_id}/async-info")
async def get_user_async_info(user_id: int):
    """æ¨¡æ‹Ÿå¼‚æ­¥æ•°æ®è·å–"""
    # æ¨¡æ‹Ÿå¼‚æ­¥æ•°æ®åº“æŸ¥è¯¢
    await asyncio.sleep(0.1)  # æ¨¡æ‹ŸI/Oå»¶è¿Ÿ

    # æ¨¡æ‹Ÿå¹¶å‘è°ƒç”¨å¤šä¸ªæœåŠ¡
    tasks = [
        asyncio.create_task(get_user_profile(user_id)),
        asyncio.create_task(get_user_stats(user_id)),
        asyncio.create_task(get_user_preferences(user_id))
    ]

    profile, stats, preferences = await asyncio.gather(*tasks)

    return {
        "profile": profile,
        "stats": stats,
        "preferences": preferences
    }

async def get_user_profile(user_id: int):
    """æ¨¡æ‹Ÿè·å–ç”¨æˆ·èµ„æ–™"""
    await asyncio.sleep(0.05)
    return {"user_id": user_id, "bio": "ç”¨æˆ·ç®€ä»‹"}

async def get_user_stats(user_id: int):
    """æ¨¡æ‹Ÿè·å–ç”¨æˆ·ç»Ÿè®¡"""
    await asyncio.sleep(0.03)
    return {"user_id": user_id, "login_count": 42}

async def get_user_preferences(user_id: int):
    """æ¨¡æ‹Ÿè·å–ç”¨æˆ·åå¥½"""
    await asyncio.sleep(0.02)
    return {"user_id": user_id, "theme": "dark"}

# å¯åŠ¨åº”ç”¨å,è®¿é—®ä»¥ä¸‹URL:
# http://localhost:8000/docs - è‡ªåŠ¨ç”Ÿæˆçš„äº¤äº’å¼APIæ–‡æ¡£(Swagger UI)
# http://localhost:8000/redoc - å¦ä¸€ç§é£æ ¼çš„APIæ–‡æ¡£
# è¿™äº›æ–‡æ¡£æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„,åŒ…å«æ‰€æœ‰ç«¯ç‚¹ã€å‚æ•°ã€å“åº”æ¨¡å‹ç­‰ä¿¡æ¯

# è¿è¡Œå‘½ä»¤: uvicorn main:app --reload
```

### 3ã€ç½‘ç»œè¯·æ±‚

#### 3.1ã€- HTTPå®¢æˆ·ç«¯

requestsæ˜¯Pythonæœ€æµè¡Œçš„HTTPåº“,APIç®€æ´æ˜“ç”¨,æ¯”Javaçš„HttpClientæ›´å‹å¥½ã€‚

```python
import requests

# åŸºæœ¬GETè¯·æ±‚ - æ¯”Java HttpClientç®€å•å¾ˆå¤š
response = requests.get('https://api.github.com/users/octocat')
print(f"çŠ¶æ€ç : {response.status_code}")  # HTTPçŠ¶æ€ç ,å¦‚200ã€404ç­‰
print(f"å“åº”å¤´: {response.headers}")     # å“åº”å¤´å­—å…¸
data = response.json()  # è‡ªåŠ¨è§£æJSONå“åº”ä¸ºPythonå­—å…¸
print(f"ç”¨æˆ·å: {data['name']}")  # è®¿é—®JSONæ•°æ®

# å¸¦æŸ¥è¯¢å‚æ•°çš„GETè¯·æ±‚
params = {'q': 'python', 'sort': 'stars', 'order': 'desc'}
response = requests.get('https://api.github.com/search/repositories', params=params)
# å®é™…è¯·æ±‚URL: https://api.github.com/search/repositories?q=python&sort=stars&order=desc

# POSTè¯·æ±‚ - å‘é€JSONæ•°æ®
user_data = {'name': 'Alice', 'email': 'alice@example.com'}
response = requests.post(
    'https://httpbin.org/post',
    json=user_data,  # è‡ªåŠ¨è®¾ç½®Content-Typeä¸ºapplication/json
    timeout=30       # 30ç§’è¶…æ—¶
)
print(response.json())  # æŸ¥çœ‹å“åº”

# POSTè¯·æ±‚ - å‘é€è¡¨å•æ•°æ®
form_data = {'username': 'alice', 'password': 'secret'}
response = requests.post(
    'https://httpbin.org/post',
    data=form_data   # å‘é€è¡¨å•æ•°æ®(application/x-www-form-urlencoded)
)

# è®¾ç½®è¯·æ±‚å¤´ - æ¯”å¦‚APIè®¤è¯
headers = {
    'Authorization': 'Bearer your-token-here',
    'User-Agent': 'MyApp/1.0',
    'Accept': 'application/json'
}
response = requests.get('https://api.example.com/data', headers=headers)

# ä¼šè¯ç®¡ç† - ä¿æŒcookieså’Œè¿æ¥å¤ç”¨
session = requests.Session()
session.headers.update({'Authorization': 'Bearer token123'})  # ä¸ºæ‰€æœ‰è¯·æ±‚è®¾ç½®å¤´

# ç™»å½•(å‡è®¾è¿”å›cookie)
login_response = session.post('https://example.com/login', {
    'username': 'alice',
    'password': 'secret'
})

# åç»­è¯·æ±‚è‡ªåŠ¨æºå¸¦cookieå’Œè®¾ç½®çš„å¤´
profile_response = session.get('https://example.com/profile')
data_response = session.get('https://example.com/api/data')

# æ–‡ä»¶ä¸Šä¼ 
files = {'file': open('document.pdf', 'rb')}  # æ‰“å¼€æ–‡ä»¶
response = requests.post('https://httpbin.org/post', files=files)
files['file'].close()  # è®°å¾—å…³é—­æ–‡ä»¶

# æˆ–ä½¿ç”¨withè¯­å¥è‡ªåŠ¨å…³é—­æ–‡ä»¶
with open('document.pdf', 'rb') as f:
    files = {'file': f}
    response = requests.post('https://httpbin.org/post', files=files)

# æ–‡ä»¶ä¸‹è½½
response = requests.get('https://example.com/large-file.zip', stream=True)
with open('downloaded-file.zip', 'wb') as f:
    for chunk in response.iter_content(chunk_size=8192):  # åˆ†å—ä¸‹è½½
        f.write(chunk)

# é”™è¯¯å¤„ç†
try:
    response = requests.get('https://api.example.com/data', timeout=5)
    response.raise_for_status()  # å¦‚æœçŠ¶æ€ç >=400åˆ™æŠ›å‡ºå¼‚å¸¸
    data = response.json()
except requests.exceptions.Timeout:
    print("è¯·æ±‚è¶…æ—¶")
except requests.exceptions.ConnectionError:
    print("è¿æ¥é”™è¯¯")
except requests.exceptions.HTTPError as e:
    print(f"HTTPé”™è¯¯: {e}")
except requests.exceptions.RequestException as e:
    print(f"è¯·æ±‚å¼‚å¸¸: {e}")
```

#### 3.2ã€- ORMæ¡†æ¶

SQLAlchemyæ˜¯Pythonæœ€å¼ºå¤§çš„ORMæ¡†æ¶,åŠŸèƒ½ç±»ä¼¼Hibernate,ä½†æ›´çµæ´»ã€‚

```python
from sqlalchemy import create_engine, Column, Integer, String, DateTime, Boolean, ForeignKey
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker, relationship
from datetime import datetime

# åˆ›å»ºåŸºç±» - ç±»ä¼¼JPAçš„@EntityåŸºç±»
Base = declarative_base()

# å®šä¹‰æ•°æ®æ¨¡å‹ - ç±»ä¼¼JPA Entity
class User(Base):
    """ç”¨æˆ·è¡¨æ¨¡å‹"""
    __tablename__ = 'users'  # æŒ‡å®šè¡¨å

    # ä¸»é”® - ç±»ä¼¼JPAçš„@Id @GeneratedValue
    id = Column(Integer, primary_key=True, autoincrement=True)

    # å­—ç¬¦ä¸²å­—æ®µ - ç±»ä¼¼JPAçš„@Column
    name = Column(String(100), nullable=False)  # VARCHAR(100) NOT NULL
    email = Column(String(255), unique=True, nullable=False)  # å”¯ä¸€çº¦æŸ

    # å¸ƒå°”å­—æ®µ
    is_active = Column(Boolean, default=True)  # é»˜è®¤å€¼

    # æ—¶é—´å­—æ®µ
    created_at = Column(DateTime, default=datetime.utcnow)  # åˆ›å»ºæ—¶é—´
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)

    # å…³è”å…³ç³» - ä¸€å¯¹å¤š
    posts = relationship("Post", back_populates="author")  # ç”¨æˆ·çš„æ‰€æœ‰æ–‡ç« 

    def __repr__(self):
        """å­—ç¬¦ä¸²è¡¨ç¤º - ç±»ä¼¼Javaçš„toString()"""
        return f"<User(id={self.id}, name='{self.name}', email='{self.email}')>"

class Post(Base):
    """æ–‡ç« è¡¨æ¨¡å‹"""
    __tablename__ = 'posts'

    id = Column(Integer, primary_key=True)
    title = Column(String(200), nullable=False)
    content = Column(String(10000))  # æ–‡ç« å†…å®¹

    # å¤–é”® - ç±»ä¼¼JPAçš„@ManyToOne
    author_id = Column(Integer, ForeignKey('users.id'), nullable=False)

    created_at = Column(DateTime, default=datetime.utcnow)

    # åå‘å…³è” - å¤šå¯¹ä¸€
    author = relationship("User", back_populates="posts")

    def __repr__(self):
        return f"<Post(id={self.id}, title='{self.title}')>"

# åˆ›å»ºæ•°æ®åº“è¿æ¥ - ç±»ä¼¼Springçš„DataSourceé…ç½®
# SQLiteç¤ºä¾‹(æ–‡ä»¶æ•°æ®åº“)
engine = create_engine('sqlite:///blog.db', echo=True)  # echo=Trueæ˜¾ç¤ºSQLæ—¥å¿—

# MySQLç¤ºä¾‹
# engine = create_engine('mysql+pymysql://user:password@localhost/blog_db')

# PostgreSQLç¤ºä¾‹
# engine = create_engine('postgresql://user:password@localhost/blog_db')

# åˆ›å»ºæ‰€æœ‰è¡¨ - ç±»ä¼¼Hibernateçš„ddl-auto=create
Base.metadata.create_all(engine)

# åˆ›å»ºä¼šè¯å·¥å‚ - ç±»ä¼¼Springçš„EntityManagerFactory
SessionLocal = sessionmaker(bind=engine)

# æ•°æ®åº“æ“ä½œç¤ºä¾‹
def create_user_and_posts():
    """åˆ›å»ºç”¨æˆ·å’Œæ–‡ç« çš„ç¤ºä¾‹"""
    # åˆ›å»ºä¼šè¯ - ç±»ä¼¼JPAçš„EntityManager
    session = SessionLocal()

    try:
        # åˆ›å»ºç”¨æˆ· - ç±»ä¼¼JPAçš„persist()
        user = User(
            name='Alice',
            email='alice@example.com',
            is_active=True
        )
        session.add(user)  # æ·»åŠ åˆ°ä¼šè¯
        session.flush()    # ç«‹å³æ‰§è¡ŒINSERT,è·å–IDä½†ä¸æäº¤äº‹åŠ¡

        print(f"åˆ›å»ºç”¨æˆ·,ID: {user.id}")

        # åˆ›å»ºæ–‡ç« 
        post1 = Post(
            title='Pythonå­¦ä¹ ç¬”è®°',
            content='ä»Šå¤©å­¦ä¹ äº†SQLAlchemy...',
            author_id=user.id
        )

        post2 = Post(
            title='Webå¼€å‘ç»éªŒ',
            content='ä½¿ç”¨Flaskå¼€å‘API...',
            author_id=user.id
        )

        session.add_all([post1, post2])  # æ‰¹é‡æ·»åŠ 
        session.commit()  # æäº¤äº‹åŠ¡ - ç±»ä¼¼JPAçš„commit()

        print(f"åˆ›å»ºæ–‡ç« : {post1.title}, {post2.title}")

    except Exception as e:
        session.rollback()  # å›æ»šäº‹åŠ¡ - ç±»ä¼¼JPAçš„rollback()
        print(f"æ“ä½œå¤±è´¥: {e}")
    finally:
        session.close()  # å…³é—­ä¼šè¯ - ç±»ä¼¼JPAçš„close()

def query_examples():
    """æŸ¥è¯¢ç¤ºä¾‹"""
    session = SessionLocal()

    try:
        # æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ· - ç±»ä¼¼JPAçš„findAll()
        all_users = session.query(User).all()
        print(f"æ‰€æœ‰ç”¨æˆ·: {all_users}")

        # æ ¹æ®IDæŸ¥è¯¢ - ç±»ä¼¼JPAçš„findById()
        user = session.query(User).get(1)  # ä¸»é”®æŸ¥è¯¢
        if user:
            print(f"ç”¨æˆ·1: {user.name}")

        # æ¡ä»¶æŸ¥è¯¢ - ç±»ä¼¼JPAçš„findByNameLike()
        active_users = session.query(User).filter(User.is_active == True).all()
        alice = session.query(User).filter(User.name == 'Alice').first()

        # å¤æ‚æ¡ä»¶æŸ¥è¯¢
        from sqlalchemy import and_, or_
        users = session.query(User).filter(
            and_(
                User.is_active == True,
                User.email.like('%@example.com')  # LIKEæ“ä½œ
            )
        ).all()

        # æ’åºå’Œåˆ†é¡µ - ç±»ä¼¼JPAçš„Pageable
        users = session.query(User).order_by(User.created_at.desc()).limit(10).offset(0).all()

        # å…³è”æŸ¥è¯¢ - ç±»ä¼¼JPAçš„JOIN FETCH
        users_with_posts = session.query(User).join(Post).all()  # INNER JOIN

        # å·¦è¿æ¥
        users_left_join = session.query(User).outerjoin(Post).all()  # LEFT JOIN

        # é¢„åŠ è½½å…³è”æ•°æ® - è§£å†³N+1é—®é¢˜
        from sqlalchemy.orm import joinedload
        users = session.query(User).options(joinedload(User.posts)).all()

        for user in users:
            print(f"ç”¨æˆ·: {user.name}")
            for post in user.posts:  # ä¸ä¼šäº§ç”Ÿé¢å¤–æŸ¥è¯¢
                print(f"  æ–‡ç« : {post.title}")

        # èšåˆæŸ¥è¯¢
        from sqlalchemy import func
        user_count = session.query(func.count(User.id)).scalar()  # COUNTæŸ¥è¯¢
        avg_posts = session.query(func.avg(func.count(Post.id))).group_by(Post.author_id).scalar()

        # æ›´æ–°æ“ä½œ - ç±»ä¼¼JPAçš„merge()
        user = session.query(User).filter(User.name == 'Alice').first()
        if user:
            user.email = 'alice.new@example.com'  # ç›´æ¥ä¿®æ”¹å±æ€§
            session.commit()  # æäº¤æ›´æ”¹

        # æ‰¹é‡æ›´æ–°
        session.query(User).filter(User.is_active == False).update({
            User.is_active: True
        })
        session.commit()

        # åˆ é™¤æ“ä½œ
        post_to_delete = session.query(Post).filter(Post.title.like('%æµ‹è¯•%')).first()
        if post_to_delete:
            session.delete(post_to_delete)
            session.commit()

        # æ‰¹é‡åˆ é™¤
        session.query(Post).filter(Post.created_at < datetime(2020, 1, 1)).delete()
        session.commit()

    finally:
        session.close()

# ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨è‡ªåŠ¨ç®¡ç†ä¼šè¯
from contextlib import contextmanager

@contextmanager
def get_db_session():
    """æ•°æ®åº“ä¼šè¯ä¸Šä¸‹æ–‡ç®¡ç†å™¨"""
    session = SessionLocal()
    try:
        yield session
        session.commit()
    except Exception:
        session.rollback()
        raise
    finally:
        session.close()

# ä½¿ç”¨ç¤ºä¾‹
def safe_database_operation():
    """å®‰å…¨çš„æ•°æ®åº“æ“ä½œ"""
    with get_db_session() as session:
        user = User(name='Bob', email='bob@example.com')
        session.add(user)
        # è‡ªåŠ¨æäº¤æˆ–å›æ»š,è‡ªåŠ¨å…³é—­ä¼šè¯

# æ‰§è¡Œç¤ºä¾‹
if __name__ == '__main__':
    create_user_and_posts()
    query_examples()
```

#### 3.3ã€æ•°æ®åº“é©±åŠ¨

å„ç§æ•°æ®åº“çš„Pythoné©±åŠ¨ç¨‹åº,ç±»ä¼¼JDBCé©±åŠ¨ã€‚

```python
# MySQL
import pymysql
conn = pymysql.connect(host='localhost', user='root', password='password', database='test')

# PostgreSQL
import psycopg2
conn = psycopg2.connect(host='localhost', database='test', user='postgres', password='password')

# Redis
import redis
r = redis.Redis(host='localhost', port=6379, db=0)
r.set('key', 'value')
print(r.get('key'))
```

### 4ã€æµ‹è¯•æ¡†æ¶

#### 4.1ã€- æ ‡å‡†åº“

Pythonå†…ç½®çš„æµ‹è¯•æ¡†æ¶,ç±»ä¼¼JUnit,æä¾›åŸºæœ¬çš„æµ‹è¯•åŠŸèƒ½ã€‚

```python
import unittest

class TestCalculator(unittest.TestCase):

    def setUp(self):
        self.calc = Calculator()

    def test_add(self):
        result = self.calc.add(2, 3)
        self.assertEqual(result, 5)

    def test_divide_by_zero(self):
        with self.assertRaises(ZeroDivisionError):
            self.calc.divide(10, 0)

if __name__ == '__main__':
    unittest.main()
```

#### 4.2ã€- ä¸»æµæµ‹è¯•æ¡†æ¶

pytestæ˜¯Pythonæœ€æµè¡Œçš„ç¬¬ä¸‰æ–¹æµ‹è¯•æ¡†æ¶,è¯­æ³•æ›´ç®€æ´,åŠŸèƒ½æ›´å¼ºå¤§ã€‚

```python
# å®‰è£…: pip install pytest

def test_add():
    assert add(2, 3) == 5

def test_divide_by_zero():
    with pytest.raises(ZeroDivisionError):
        divide(10, 0)

# å‚æ•°åŒ–æµ‹è¯•
import pytest

@pytest.mark.parametrize("a,b,expected", [
    (2, 3, 5),
    (1, 1, 2),
    (0, 5, 5)
])
def test_add_parametrized(a, b, expected):
    assert add(a, b) == expected

# è¿è¡Œ: pytest test_file.py
```

#### 4.3ã€- æ¨¡æ‹Ÿå¯¹è±¡

mockåº“ç”¨äºåˆ›å»ºæ¨¡æ‹Ÿå¯¹è±¡,ä¾¿äºå•å…ƒæµ‹è¯•,ç±»ä¼¼Mockitoã€‚

```python
from unittest.mock import Mock, patch

# Mockå¯¹è±¡
mock_api = Mock()
mock_api.get_user.return_value = {'name': 'Alice', 'id': 1}

# ä½¿ç”¨patchè£…é¥°å™¨
@patch('requests.get')
def test_api_call(mock_get):
    mock_get.return_value.json.return_value = {'status': 'ok'}
    result = api_call()
    assert result['status'] == 'ok'
```

### 5ã€å…¶ä»–å®ç”¨åº“

#### 5.1ã€- HTMLè§£æ

BeautifulSoupæ˜¯HTML/XMLè§£æåº“,ç”¨äºç½‘é¡µçˆ¬è™«å’Œæ•°æ®æå–,ç±»ä¼¼Jsoupã€‚

```python
from bs4 import BeautifulSoup
import requests

# ç½‘é¡µæŠ“å–
response = requests.get('https://example.com')
soup = BeautifulSoup(response.content, 'html.parser')

# è§£æHTML
title = soup.find('title').text
links = soup.find_all('a')
for link in links:
    print(link.get('href'))
```

#### 5.2ã€- å›¾åƒå¤„ç†

Pillowæ˜¯Pythonå›¾åƒå¤„ç†åº“,æ”¯æŒå¤šç§å›¾åƒæ ¼å¼å’ŒåŸºæœ¬çš„å›¾åƒæ“ä½œã€‚

```python
from PIL import Image, ImageFilter

# æ‰“å¼€å›¾åƒ
img = Image.open('photo.jpg')

# åŸºæœ¬æ“ä½œ
resized = img.resize((100, 100))
rotated = img.rotate(45)
filtered = img.filter(ImageFilter.BLUR)

# ä¿å­˜
resized.save('thumbnail.jpg')
```

#### 5.3ã€python-dotenv - ç¯å¢ƒå˜é‡ç®¡ç†

python-dotenvç”¨äºä».envæ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡,ä¾¿äºé…ç½®ç®¡ç†ã€‚

```python
# .envæ–‡ä»¶
# DATABASE_URL=postgresql://localhost/mydb
# SECRET_KEY=mysecretkey

from dotenv import load_dotenv
import os

# åŠ è½½.envæ–‡ä»¶
load_dotenv()

# ä½¿ç”¨ç¯å¢ƒå˜é‡
database_url = os.getenv('DATABASE_URL')
secret_key = os.getenv('SECRET_KEY')
```

**ç”Ÿæ€å¯¹æ¯”:**

| é¢†åŸŸ | Pythonåº“ | Javaå¯¹åº” |
|-----|----------|---------|
| Webæ¡†æ¶ | Django, Flask, FastAPI | Spring Boot, Spring MVC |
| ORM | SQLAlchemy | JPA/Hibernate |
| HTTPå®¢æˆ·ç«¯ | requests, httpx | Apache HttpClient, OkHttp |
| æµ‹è¯• | pytest, unittest | JUnit, TestNG |
| JSON | json (å†…ç½®) | Jackson, Gson |
| æ—¥å¿— | logging (å†…ç½®) | Logback, Log4j |
| åŒ…ç®¡ç† | pip, conda | Maven, Gradle |
| æ•°æ®ç§‘å­¦ | NumPy, Pandas | - (éœ€ç¬¬ä¸‰æ–¹åº“) |

## äºŒã€ä»£ç è´¨é‡ä¸å·¥ç¨‹å®è·µ

å¯¹äºä»Javaè½¬æ¥çš„å¼€å‘è€…ï¼ŒPythonçš„å·¥ç¨‹å®è·µå¯èƒ½æ˜¾å¾—æ›´åŠ çµæ´»ï¼Œä½†ä¹Ÿéœ€è¦æ›´å¼ºçš„è‡ªå¾‹æ€§ã€‚Javaæœ‰ä¸¥æ ¼çš„ç¼–ç è§„èŒƒå’Œæˆç†Ÿçš„å·¥ç¨‹ä½“ç³»ï¼Œè€ŒPythonåˆ™æä¾›äº†æ›´å¤šé€‰æ‹©ï¼Œéœ€è¦å›¢é˜Ÿå»ºç«‹è‡ªå·±çš„æœ€ä½³å®è·µã€‚

### 1ã€ä»£ç è§„èŒƒ

#### 1.1ã€PEP 8ç¼–ç è§„èŒƒ

PEP 8æ˜¯Pythonå®˜æ–¹çš„ç¼–ç é£æ ¼æŒ‡å—ï¼Œç›¸å½“äºJavaä¸–ç•Œçš„Google Java Style Guideã€‚

**ç¼©è¿›ä¸ç©ºæ ¼**ï¼š
```python
# âœ… æ­£ç¡®ï¼šä½¿ç”¨4ä¸ªç©ºæ ¼ç¼©è¿›
def calculate_total(items):
    total = 0
    for item in items:
        total += item.price
    return total

# âŒ é”™è¯¯ï¼šä½¿ç”¨Tabç¼©è¿›
def calculate_total(items):
	total = 0
	for item in items:
		total += item.price
	return total

# âœ… æ­£ç¡®ï¼šè¿ç®—ç¬¦ä¸¤ä¾§æœ‰ç©ºæ ¼
result = a + b * c

# âœ… æ­£ç¡®ï¼šå‡½æ•°å‚æ•°é»˜è®¤å€¼ç­‰å·ä¸¤ä¾§æ— ç©ºæ ¼
def create_user(name, age=25, active=True):
    pass

# âŒ é”™è¯¯ï¼šå‚æ•°é»˜è®¤å€¼ç­‰å·ä¸¤ä¾§æœ‰ç©ºæ ¼
def create_user(name, age = 25, active = True):
    pass
```

**è¡Œé•¿åº¦ä¸æ¢è¡Œ**ï¼š
```python
# âœ… æ­£ç¡®ï¼šæ¯è¡Œä¸è¶…è¿‡79å­—ç¬¦
def process_user_data(user_id, user_name, email, phone, address, city, country):
    return user_id

# âœ… æ­£ç¡®ï¼šé•¿è¡Œæ¢è¡Œä½¿ç”¨æ‹¬å·æˆ–åæ–œæ 
long_variable_name = some_function_with_very_long_name(
    parameter1, parameter2, parameter3, parameter4
)

# æˆ–ä½¿ç”¨åæ–œæ 
result = (first_value + second_value + third_value +
          fourth_value + fifth_value)

# âœ… æ­£ç¡®ï¼šäºŒå…ƒè¿ç®—ç¬¦æ¢è¡Œåœ¨æ“ä½œç¬¦å‰
income = (gross_wages
          + taxable_interest
          + (dividends - qualified_dividends)
          - ira_deduction
          - student_loan_interest)
```

**å¯¼å…¥è¯­å¥**ï¼š
```python
# âœ… æ­£ç¡®ï¼šå¯¼å…¥é¡ºåºï¼ˆæ ‡å‡†åº“ -> ç¬¬ä¸‰æ–¹åº“ -> æœ¬åœ°æ¨¡å—ï¼‰
import os
import sys
from datetime import datetime

import requests
import numpy as np

from myproject.utils import helper
from myproject.models import User

# âœ… æ­£ç¡®ï¼šé¿å…ä½¿ç”¨é€šé…ç¬¦å¯¼å…¥
from math import sqrt, sin, cos  # æ¨è
# from math import *  # ä¸æ¨è

# âœ… æ­£ç¡®ï¼šå¤šè¡Œå¯¼å…¥
from collections import (
    defaultdict,
    OrderedDict,
    Counter,
    deque
)
```

å¯¹æ¯”Javaçš„importé£æ ¼ï¼š
```java
// Java: æŒ‰å­—æ¯é¡ºåºï¼Œä½¿ç”¨é€šé…ç¬¦æ˜¯å¸¸è§çš„
import java.util.*;
import java.io.*;
import com.example.models.*;
```

#### 1.2ã€å‘½åçº¦å®š

Pythonçš„å‘½åçº¦å®šä¸Javaæœ‰æ˜æ˜¾å·®å¼‚ï¼š

| ç±»å‹ | Pythoné£æ ¼ | Javaé£æ ¼ | ç¤ºä¾‹ |
|-----|-----------|---------|-----|
| å˜é‡/å‡½æ•° | snake_case | camelCase | `user_name`, `get_user_info()` |
| ç±»å | PascalCase | PascalCase | `UserService`, `HttpClient` |
| å¸¸é‡ | UPPER_SNAKE_CASE | UPPER_SNAKE_CASE | `MAX_RETRY_COUNT` |
| ç§æœ‰æˆå‘˜ | _prefix | private | `_internal_method` |
| æ¨¡å—å | lowercase | lowercase | `user_service.py` |

**å…·ä½“ç¤ºä¾‹**ï¼š
```python
# âœ… æ­£ç¡®çš„Pythonå‘½å
class UserService:
    MAX_RETRY_COUNT = 3
    _instance_count = 0

    def __init__(self, db_connection):
        self.db_connection = db_connection
        UserService._instance_count += 1

    def get_user_by_id(self, user_id):
        """æ ¹æ®IDè·å–ç”¨æˆ·ä¿¡æ¯"""
        query = f"SELECT * FROM users WHERE id = {user_id}"
        return self.db_connection.execute(query)

    def _validate_user_data(self, user_data):
        """å†…éƒ¨æ–¹æ³•ï¼šéªŒè¯ç”¨æˆ·æ•°æ®"""
        pass

# âœ… æ­£ç¡®çš„æ¨¡å—çº§å‘½å
def calculate_total_price(items, tax_rate=0.08):
    total = sum(item.price for item in items)
    return total * (1 + tax_rate)

API_BASE_URL = "https://api.example.com"
DEFAULT_TIMEOUT = 30
```

**ç‰¹æ®Šå‘½åçº¦å®š**ï¼š
```python
class DatabaseConnection:
    def __init__(self):
        self._connection = None          # å•ä¸‹åˆ’çº¿ï¼šå—ä¿æŠ¤æˆå‘˜
        self.__password = "secret"       # åŒä¸‹åˆ’çº¿ï¼šåç§°æ”¹å†™ï¼ˆçœŸæ­£ç§æœ‰ï¼‰

    def _internal_query(self, sql):      # å†…éƒ¨ä½¿ç”¨çš„æ–¹æ³•
        return self._connection.execute(sql)

    def __init_connection(self):         # åç§°æ”¹å†™åå˜ä¸º _DatabaseConnection__init_connection
        pass

    def connect(self):
        self.__init_connection()         # åªèƒ½åœ¨ç±»å†…éƒ¨è°ƒç”¨

    def __str__(self):                   # é­”æœ¯æ–¹æ³•ï¼šåŒä¸‹åˆ’çº¿å‰å
        return f"DatabaseConnection()"
```

#### 1.3ã€æ–‡æ¡£å­—ç¬¦ä¸²ï¼ˆDocstringï¼‰

Pythonä½¿ç”¨docstringä»£æ›¿Javaçš„Javadocï¼Œæ ¼å¼æ›´åŠ ç®€æ´ã€‚

**ä¸‰ç§å¸¸ç”¨docstringæ ¼å¼**ï¼š

```python
class Calculator:
    """è®¡ç®—å™¨ç±»ç¤ºä¾‹

    æä¾›åŸºæœ¬çš„æ•°å­¦è¿ç®—åŠŸèƒ½ã€‚

    Attributes:
        precision (int): è®¡ç®—ç²¾åº¦ï¼Œé»˜è®¤ä¸º2ä½å°æ•°
        history (list): è®¡ç®—å†å²è®°å½•
    """

    def __init__(self, precision=2):
        """åˆå§‹åŒ–è®¡ç®—å™¨

        Args:
            precision (int): è®¡ç®—ç²¾åº¦ï¼Œé»˜è®¤ä¸º2ä½å°æ•°

        Example:
            >>> calc = Calculator(4)
            >>> calc.precision
            4
        """
        self.precision = precision
        self.history = []

    def add(self, a, b):
        """åŠ æ³•è¿ç®—

        Args:
            a (float): ç¬¬ä¸€ä¸ªæ•°
            b (float): ç¬¬äºŒä¸ªæ•°

        Returns:
            float: ä¸¤æ•°ä¹‹å’Œ

        Raises:
            TypeError: å½“è¾“å…¥ä¸æ˜¯æ•°å­—æ—¶

        Example:
            >>> calc = Calculator()
            >>> calc.add(1.5, 2.3)
            3.8
        """
        if not isinstance(a, (int, float)) or not isinstance(b, (int, float)):
            raise TypeError("è¾“å…¥å¿…é¡»æ˜¯æ•°å­—")

        result = round(a + b, self.precision)
        self.history.append(f"{a} + {b} = {result}")
        return result
```

**Googleé£æ ¼docstring**ï¼š
```python
def calculate_bmi(weight, height):
    """è®¡ç®—BMIæŒ‡æ•°

    ä½¿ç”¨æ ‡å‡†BMIå…¬å¼ï¼šBMI = ä½“é‡(kg) / èº«é«˜(m)Â²

    Args:
        weight (float): ä½“é‡ï¼Œå•ä½åƒå…‹
        height (float): èº«é«˜ï¼Œå•ä½ç±³

    Returns:
        float: BMIæŒ‡æ•°ï¼Œä¿ç•™ä¸€ä½å°æ•°

    Raises:
        ValueError: å½“ä½“é‡æˆ–èº«é«˜ä¸º0æˆ–è´Ÿæ•°æ—¶

    Example:
        >>> calculate_bmi(70, 1.75)
        22.9
    """
    if weight <= 0 or height <= 0:
        raise ValueError("ä½“é‡å’Œèº«é«˜å¿…é¡»å¤§äº0")

    bmi = weight / (height ** 2)
    return round(bmi, 1)
```

#### 1.4ã€æ³¨é‡Šæœ€ä½³å®è·µ

Pythonçš„æ³¨é‡Šé£æ ¼æ¯”Javaæ›´ç®€æ´ï¼Œä½†åŒæ ·é‡è¦ã€‚

**å•è¡Œæ³¨é‡Š**ï¼š
```python
# âœ… å¥½çš„æ³¨é‡Šï¼šè§£é‡Šä¸ºä»€ä¹ˆï¼Œè€Œä¸æ˜¯åšä»€ä¹ˆ
if user.is_active:  # åªå¤„ç†æ´»è·ƒç”¨æˆ·ï¼Œé¿å…å¤„ç†å·²åˆ é™¤ç”¨æˆ·
    send_notification(user)

# âœ… å¥½çš„æ³¨é‡Šï¼šè§£é‡Šå¤æ‚ç®—æ³•
# ä½¿ç”¨æ»‘åŠ¨çª—å£ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦O(n)
max_sum = max_subarray_sum(numbers)

# âŒ ä¸å¥½çš„æ³¨é‡Šï¼šé‡å¤ä»£ç æœ¬èº«
age = 25  # è®¾ç½®å¹´é¾„ä¸º25
```

**TODOå’ŒFIXME**ï¼š
```python
class UserService:
    def get_user_profile(self, user_id):
        # TODO: æ·»åŠ ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é¢‘ç¹æŸ¥è¯¢æ•°æ®åº“
        profile = self.db.get_user_profile(user_id)

        # FIXME: è¿™é‡Œæ²¡æœ‰å¤„ç†ç”¨æˆ·ä¸å­˜åœ¨çš„æƒ…å†µ
        return profile
```

### 2ã€ä»£ç æ£€æŸ¥å·¥å…·

Pythonç”Ÿæ€æä¾›äº†ä¸°å¯Œçš„ä»£ç è´¨é‡å·¥å…·ï¼Œç±»ä¼¼äºJavaçš„SonarQubeã€Checkstyleç­‰ã€‚

#### 2.1ã€pylint

pylintæ˜¯æœ€å…¨é¢çš„ä»£ç æ£€æŸ¥å·¥å…·ï¼Œç±»ä¼¼äºJavaçš„SpotBugsã€‚

```bash
# å®‰è£…pylint
pip install pylint

# æ£€æŸ¥å•ä¸ªæ–‡ä»¶
pylint mymodule.py

# æ£€æŸ¥æ•´ä¸ªåŒ…
pylint mypackage/

# ç”ŸæˆæŠ¥å‘Š
pylint --output-format=json:report.json mymodule.py
```

**pylinté…ç½®æ–‡ä»¶ `.pylintrc`**ï¼š
```ini
[MASTER]
# æŒ‡å®šåˆå§‹åŒ–æ—¶åŠ è½½çš„æ¨¡å—
load-plugins=pylint_django,pylint_flask

[FORMAT]
# æœ€å¤§è¡Œé•¿åº¦
max-line-length=88
# ç¼©è¿›é£æ ¼
indent-string='    '

[DESIGN]
# æœ€å¤§å…¬å…±æ–¹æ³•æ•°é‡
max-public-methods=20
# æœ€å¤§å±æ€§æ•°é‡
max-attributes=7

[MESSAGES CONTROL]
# ç¦ç”¨çš„æ£€æŸ¥
disable=missing-docstring,
        too-few-public-methods,
        invalid-name

[TYPECHECK]
# å¿½ç•¥æŸäº›ç±»å‹æ£€æŸ¥
ignored-classes=optparse.Values,thread._local_dict
```

**å¸¸è§pylintæ¶ˆæ¯**ï¼š
```python
# C0111: missing-docstring (ç¼ºå°‘æ–‡æ¡£å­—ç¬¦ä¸²)
def calculate(x, y):
    return x + y

# R0201: no-self-use (æ–¹æ³•ä¸­æ²¡æœ‰ä½¿ç”¨self)
class MyClass:
    def utility_method(self):  # åº”è¯¥æ”¹ä¸ºé™æ€æ–¹æ³•
        return 42

# W0612: unused-variable (æœªä½¿ç”¨çš„å˜é‡)
def process_data():
    result, temp = get_result()  # tempæœªä½¿ç”¨
    return result

# E1101: no-member (å¯¹è±¡æ²¡æœ‰è¿™ä¸ªå±æ€§)
class User:
    def __init__(self):
        self.name = "å¼ ä¸‰"

user = User()
print(user.full_name)  # E1101: User has no member 'full_name'
```

#### 2.2ã€flake8

flake8æ˜¯å¤šä¸ªå·¥å…·çš„ç»„åˆï¼Œæ›´è½»é‡çº§ï¼Œä¸“æ³¨äºä»£ç é£æ ¼å’Œå¸¸è§é”™è¯¯ã€‚

```bash
# å®‰è£…flake8
pip install flake8

# åŸºæœ¬ä½¿ç”¨
flake8 mymodule.py

# é…ç½®æ–‡ä»¶
flake8 --config=.flake8 mymodule.py

# å¿½ç•¥ç‰¹å®šé”™è¯¯
flake8 --ignore=E501,W503 mymodule.py
```

**é…ç½®æ–‡ä»¶ `.flake8`**ï¼š
```ini
[flake8]
max-line-length = 88
extend-ignore = E203, W503
exclude =
    .git,
    __pycache__,
    .venv,
    build,
    dist
per-file-ignores =
    __init__.py:F401
    tests/*:S101
```

**å¸¸è§flake8é”™è¯¯ä»£ç **ï¼š
- `E`ç³»åˆ—ï¼šé”™è¯¯ï¼ˆErrorsï¼‰
- `W`ç³»åˆ—ï¼šè­¦å‘Šï¼ˆWarningsï¼‰
- `F`ç³»åˆ—ï¼šPyFlakesæ£€æŸ¥
- `C`ç³»åˆ—ï¼šå¤æ‚åº¦æ£€æŸ¥ï¼ˆmccabeï¼‰

```python
# E302: æœŸæœ›2ä¸ªç©ºè¡Œ
def func1(): pass
def func2(): pass

# E501: è¡Œå¤ªé•¿
very_long_variable_name = some_function_with_very_long_name(parameter1, parameter2)

# F401: å¯¼å…¥ä½†æœªä½¿ç”¨
import os
import sys  # F401: 'sys' imported but unused

# C901: å‡½æ•°å¤ªå¤æ‚
def complex_function(data):
    if condition1:
        if condition2:
            if condition3:
                # å¤šå±‚åµŒå¥—
                pass
```

#### 2.3ã€blackï¼ˆä»£ç æ ¼å¼åŒ–ï¼‰

blackæ˜¯"ä¸å¦¥åçš„ä»£ç æ ¼å¼åŒ–å·¥å…·"ï¼Œç±»ä¼¼äºJavaçš„Google Java Formatã€‚

```bash
# å®‰è£…black
pip install black

# æ ¼å¼åŒ–å•ä¸ªæ–‡ä»¶
black mymodule.py

# æ ¼å¼åŒ–æ•´ä¸ªé¡¹ç›®
black .

# æ£€æŸ¥æ ¼å¼ä½†ä¸ä¿®æ”¹
black --check .

# æ˜¾ç¤ºå·®å¼‚
black --diff mymodule.py
```

**blacké…ç½® `pyproject.toml`**ï¼š
```toml
[tool.black]
line-length = 88
target-version = ['py38', 'py39']
include = '\.pyi?$'
extend-exclude = '''
/(
  # æ’é™¤çš„ç›®å½•
  \.eggs
  | \.git
  | \.venv
  | build
  | dist
)/
'''
```

**blackçš„æ ¼å¼åŒ–ç¤ºä¾‹**ï¼š
```python
# æ ¼å¼åŒ–å‰
def complex_function(a,b,c=10,*args,**kwargs):
    x=a+b+c
    if x>100:
        return "large"
    else:
        return "small"

# blackæ ¼å¼åŒ–å
def complex_function(a, b, c=10, *args, **kwargs):
    x = a + b + c
    if x > 100:
        return "large"
    else:
        return "small"
```

#### 2.4ã€isortï¼ˆå¯¼å…¥æ’åºï¼‰

isortä¸“é—¨ç”¨äºæ•´ç†importè¯­å¥ï¼Œç±»ä¼¼äºIDEçš„è‡ªåŠ¨importæ•´ç†åŠŸèƒ½ã€‚

```bash
# å®‰è£…isort
pip install isort

# æ’åºå¯¼å…¥
isort mymodule.py

# æ£€æŸ¥å¯¼å…¥ï¼ˆä¸ä¿®æ”¹ï¼‰
isort --check-only mymodule.py

# é…ç½®æ–‡ä»¶
isort --settings-file .isort.cfg mymodule.py
```

**é…ç½®æ–‡ä»¶ `.isort.cfg`**ï¼š
```ini
[settings]
profile = black
multi_line_output = 3
line_length = 88
known_first_party = myproject
known_third_party = requests, numpy, pandas
sections = FUTURE,STDLIB,THIRDPARTY,FIRSTPARTY,LOCALFOLDER
```

**isortæ•ˆæœç¤ºä¾‹**ï¼š
```python
# æ’åºå‰
import numpy
from myproject.utils import helper
import os
import sys
from collections import defaultdict
import requests

# isortæ’åºå
import os
import sys

from collections import defaultdict

import numpy
import requests

from myproject.utils import helper
```

#### 2.5ã€å·¥å…·é›†æˆ

**pre-commité’©å­é…ç½® `.pre-commit-config.yaml`**ï¼š
```yaml
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files

  - repo: https://github.com/psf/black
    rev: 22.3.0
    hooks:
      - id: black

  - repo: https://github.com/pycqa/isort
    rev: 5.10.1
    hooks:
      - id: isort

  - repo: https://github.com/pycqa/flake8
    rev: 4.0.1
    hooks:
      - id: flake8

  - repo: local
    hooks:
      - id: pylint
        name: pylint
        entry: pylint
        language: system
        types: [python]
```

**å®‰è£…pre-commit**ï¼š
```bash
pip install pre-commit
pre-commit install
```

**IDEé›†æˆé…ç½®**ï¼š
```json
// VSCode settings.json
{
    "python.linting.enabled": true,
    "python.linting.pylintEnabled": true,
    "python.linting.flake8Enabled": true,
    "python.formatting.provider": "black",
    "editor.formatOnSave": true,
    "editor.codeActionsOnSave": {
        "source.organizeImports": true
    }
}
```

### 3ã€è™šæ‹Ÿç¯å¢ƒç®¡ç†

Pythonçš„è™šæ‹Ÿç¯å¢ƒç›¸å½“äºJavaçš„Maven/Gradleé¡¹ç›®éš”ç¦»ï¼Œä½†æ›´è½»é‡çº§ã€‚

#### 3.1ã€venvå®è·µ

**åˆ›å»ºå’Œä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ**ï¼š
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv myproject_env

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
myproject_env\Scripts\activate
# macOS/Linux
source myproject_env/bin/activate

# å®‰è£…åŒ…
pip install requests pandas numpy

# æŸ¥çœ‹å·²å®‰è£…çš„åŒ…
pip list

# å¯¼å‡ºä¾èµ–
pip freeze > requirements.txt

# é€€å‡ºè™šæ‹Ÿç¯å¢ƒ
deactivate
```

**é¡¹ç›®ç»“æ„ç¤ºä¾‹**ï¼š
```
myproject/
â”œâ”€â”€ .venv/                 # è™šæ‹Ÿç¯å¢ƒç›®å½•
â”œâ”€â”€ src/
â”‚   â””â”€â”€ mypackage/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ main.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_main.py
â”œâ”€â”€ requirements.txt       # ç”Ÿäº§ä¾èµ–
â”œâ”€â”€ requirements-dev.txt   # å¼€å‘ä¾èµ–
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â””â”€â”€ pyproject.toml        # é¡¹ç›®é…ç½®
```

**æœ€ä½³å®è·µ**ï¼š
```bash
# 1. æ¯ä¸ªé¡¹ç›®ä½¿ç”¨ç‹¬ç«‹çš„è™šæ‹Ÿç¯å¢ƒ
python -m venv .venv

# 2. æ¿€æ´»ç¯å¢ƒåå®‰è£…ä¾èµ–
source .venv/bin/activate  # Linux/Mac
# .venv\Scripts\activate  # Windows

# 3. å‡çº§pip
pip install --upgrade pip

# 4. å®‰è£…é¡¹ç›®ä¾èµ–
pip install -r requirements.txt

# 5. å¼€å‘ç¯å¢ƒé¢å¤–ä¾èµ–
pip install -r requirements-dev.txt
```

#### 3.2ã€requirements.txtç®¡ç†

**requirements.txtç¤ºä¾‹**ï¼š
```txt
# æ ¸å¿ƒä¾èµ–
Django==4.2.0
requests==2.31.0
pandas==2.0.3
numpy==1.24.3

# å®‰å…¨å›ºå®š
cryptography==41.0.1
urllib3==1.26.16

# å…¼å®¹æ€§èŒƒå›´
python-dateutil>=2.8.0,<3.0.0
click>=8.0.0,<9.0.0
```

**requirements-dev.txtç¤ºä¾‹**ï¼š
```txt
# åŒ…å«ç”Ÿäº§ä¾èµ–
-r requirements.txt

# å¼€å‘å·¥å…·
pytest==7.4.0
pytest-cov==4.1.0
black==23.3.0
flake8==6.0.0
mypy==1.4.1

# æ–‡æ¡£ç”Ÿæˆ
sphinx==7.1.2
sphinx-rtd-theme==1.3.0
```

**ç‰ˆæœ¬çº¦æŸç­–ç•¥**ï¼š
```txt
# å›ºå®šç‰ˆæœ¬ï¼ˆç”Ÿäº§æ¨èï¼‰
requests==2.31.0

# å…¼å®¹ç‰ˆæœ¬ï¼ˆå…è®¸å°ç‰ˆæœ¬æ›´æ–°ï¼‰
requests>=2.30.0,<3.0.0

# æœ€å°ç‰ˆæœ¬ï¼ˆä¸æ¨èç”Ÿäº§ä½¿ç”¨ï¼‰
requests>=2.25.0

# ä¸æŒ‡å®šç‰ˆæœ¬ï¼ˆå±é™©ï¼‰
requests
```

**ç”Ÿæˆrequirements.txt**ï¼š
```bash
# ç²¾ç¡®ç‰ˆæœ¬
pip freeze > requirements.txt

# åªåŒ…å«é¡¶çº§åŒ…
pip list --format=freeze > requirements.txt

# ä½¿ç”¨pip-toolsç®¡ç†
pip install pip-tools
pip-compile requirements.in  # ç”Ÿæˆrequirements.txt
```

**requirements.inç¤ºä¾‹**ï¼š
```ini
# requirements.in - åªæŒ‡å®šä¸»è¦ä¾èµ–
django
requests
pandas>=1.5.0
```

#### 3.3ã€poetryä¾èµ–ç®¡ç†

Poetryæ˜¯ç°ä»£Pythonä¾èµ–ç®¡ç†å·¥å…·ï¼Œç±»ä¼¼äºJavaçš„Maven/Gradleã€‚

**å®‰è£…Poetry**ï¼š
```bash
# å®˜æ–¹æ¨èå®‰è£…æ–¹å¼
curl -sSL https://install.python-poetry.org | python3 -

# æˆ–ä½¿ç”¨pip
pip install poetry
```

**åˆå§‹åŒ–é¡¹ç›®**ï¼š
```bash
# åˆ›å»ºæ–°é¡¹ç›®
poetry new myproject
cd myproject

# åœ¨ç°æœ‰é¡¹ç›®ä¸­åˆå§‹åŒ–
poetry init
```

**pyproject.tomlé…ç½®**ï¼š
```toml
[tool.poetry]
name = "myproject"
version = "0.1.0"
description = "My Python project"
authors = ["Your Name <you@example.com>"]
readme = "README.md"
packages = [{include = "myproject"}]

[tool.poetry.dependencies]
python = "^3.8"
requests = "^2.31.0"
pandas = "^2.0.0"

[tool.poetry.group.dev.dependencies]
pytest = "^7.4.0"
black = "^23.3.0"
flake8 = "^6.0.0"
mypy = "^1.4.0"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"

[tool.black]
line-length = 88
target-version = ['py38']

[tool.mypy]
python_version = "3.8"
warn_return_any = true
warn_unused_configs = true
```

**Poetryå¸¸ç”¨å‘½ä»¤**ï¼š
```bash
# å®‰è£…ä¾èµ–
poetry install

# åªå®‰è£…ç”Ÿäº§ä¾èµ–
poetry install --only=main

# æ·»åŠ ä¾èµ–
poetry add requests
poetry add --group dev pytest  # æ·»åŠ å¼€å‘ä¾èµ–

# æ›´æ–°ä¾èµ–
poetry update
poetry update requests

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒå¹¶è¿è¡Œå‘½ä»¤
poetry run python myscript.py
poetry run pytest

# è¿›å…¥è™šæ‹Ÿç¯å¢ƒshell
poetry shell

# æ˜¾ç¤ºä¾èµ–æ ‘
poetry show --tree

# å¯¼å‡ºrequirements.txt
poetry export -f requirements.txt --output requirements.txt

# æ„å»ºåŒ…
poetry build

# å‘å¸ƒåˆ°PyPI
poetry publish
```

**Poetry vs pipå¯¹æ¯”**ï¼š

| ç‰¹æ€§ | pip + requirements.txt | Poetry |
|-----|-----------------------|---------|
| ä¾èµ–è§£æ | åŸºç¡€ | é«˜çº§ï¼ˆè§£å†³å†²çªï¼‰ |
| é”å®šæ–‡ä»¶ | æ‰‹åŠ¨ | è‡ªåŠ¨ï¼ˆpoetry.lockï¼‰ |
| è™šæ‹Ÿç¯å¢ƒ | æ‰‹åŠ¨ç®¡ç† | è‡ªåŠ¨ç®¡ç† |
| ä¾èµ–åˆ†ç»„ | å¤šä¸ªæ–‡ä»¶ | é…ç½®æ–‡ä»¶ä¸­åˆ†ç»„ |
| æ„å»ºå‘å¸ƒ | éœ€è¦é¢å¤–å·¥å…· | å†…ç½®æ”¯æŒ |
| è„šæœ¬ç®¡ç† | æ—  | å†…ç½®æ”¯æŒ |

**ä¼ä¸šçº§Poetryé…ç½®**ï¼š
```toml
# pyproject.toml
[[tool.poetry.source]]
name = "private-pypi"
url = "https://pypi.company.com/simple"
default = false
secondary = true

[tool.poetry.scripts]
myproject-cli = "myproject.cli:main"

[tool.poetry.group.test.dependencies]
pytest = "^7.4.0"
pytest-cov = "^4.1.0"

[tool.poetry.group.docs.dependencies]
sphinx = "^7.1.0"
```

### 4ã€å•å…ƒæµ‹è¯•

Pythonçš„æµ‹è¯•ç”Ÿæ€æ¯”Javaçš„JUnitæ›´åŠ çµæ´»å’Œå¼ºå¤§ã€‚pytestæ˜¯å½“å‰æœ€æµè¡Œçš„æµ‹è¯•æ¡†æ¶ï¼Œæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½å’Œæ’ä»¶ã€‚

#### 4.1ã€pyteståŸºç¡€

**å®‰è£…pytest**ï¼š
```bash
pip install pytest
```

**åŸºæœ¬æµ‹è¯•ç¤ºä¾‹**ï¼š
```python
# calculator.py
class Calculator:
    def add(self, a, b):
        return a + b

    def divide(self, a, b):
        if b == 0:
            raise ValueError("é™¤æ•°ä¸èƒ½ä¸º0")
        return a / b

    def is_even(self, number):
        return number % 2 == 0
```

```python
# test_calculator.py
import pytest
from calculator import Calculator

class TestCalculator:
    def setup_method(self):
        """æ¯ä¸ªæµ‹è¯•æ–¹æ³•å‰æ‰§è¡Œ"""
        self.calc = Calculator()

    def test_add_positive_numbers(self):
        result = self.calc.add(2, 3)
        assert result == 5

    def test_add_negative_numbers(self):
        result = self.calc.add(-2, -3)
        assert result == -5

    def test_divide_normal(self):
        result = self.calc.divide(10, 2)
        assert result == 5

    def test_divide_by_zero(self):
        with pytest.raises(ValueError, match="é™¤æ•°ä¸èƒ½ä¸º0"):
            self.calc.divide(10, 0)

    @pytest.mark.parametrize("number,expected", [
        (2, True),
        (3, False),
        (0, True),
        (-4, True),
    ])
    def test_is_even(self, number, expected):
        result = self.calc.is_even(number)
        assert result == expected
```

**è¿è¡Œæµ‹è¯•**ï¼š
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæ–‡ä»¶
pytest test_calculator.py

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–¹æ³•
pytest test_calculator.py::TestCalculator::test_add_positive_numbers

# æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
pytest -v

# åœ¨ç¬¬ä¸€ä¸ªå¤±è´¥æ—¶åœæ­¢
pytest -x

# æ˜¾ç¤ºè¦†ç›–ç‡
pytest --cov=calculator
```

#### 4.2ã€æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰

TDDåœ¨Pythonä¸­æ¯”Javaæ›´ç®€æ´ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…ä¾‹å­æ¥å±•ç¤ºï¼š

**éœ€æ±‚ï¼šå®ç°ä¸€ä¸ªå¯†ç éªŒè¯å™¨**

**1. å…ˆå†™æµ‹è¯•ï¼ˆçº¢ï¼‰**ï¼š
```python
# test_password_validator.py
import pytest
from password_validator import PasswordValidator

class TestPasswordValidator:
    def setup_method(self):
        self.validator = PasswordValidator()

    def test_valid_password(self):
        password = "MySecure123!"
        assert self.validator.validate(password) == True

    def test_too_short_password(self):
        password = "Short1!"
        assert self.validator.validate(password) == False

    def test_missing_uppercase(self):
        password = "mysecure123!"
        assert self.validator.validate(password) == False

    def test_missing_lowercase(self):
        password = "MYSECURE123!"
        assert self.validator.validate(password) == False

    def test_missing_number(self):
        password = "MySecure!"
        assert self.validator.validate(password) == False

    def test_missing_special_char(self):
        password = "MySecure123"
        assert self.validator.validate(password) == False

    def test_get_error_messages(self):
        password = "weak"
        errors = self.validator.get_errors(password)
        assert "å¯†ç é•¿åº¦è‡³å°‘8ä½" in errors
        assert "å¿…é¡»åŒ…å«å¤§å†™å­—æ¯" in errors
        assert "å¿…é¡»åŒ…å«å°å†™å­—æ¯" in errors
        assert "å¿…é¡»åŒ…å«æ•°å­—" in errors
        assert "å¿…é¡»åŒ…å«ç‰¹æ®Šå­—ç¬¦" in errors
```

**2. è¿è¡Œæµ‹è¯•ï¼ˆå¤±è´¥ï¼‰**ï¼š
```bash
pytest test_password_validator.py
# ä¼šå¤±è´¥ï¼Œå› ä¸ºPasswordValidatorè¿˜ä¸å­˜åœ¨
```

**3. å®ç°æœ€å°ä»£ç ï¼ˆç»¿ï¼‰**ï¼š
```python
# password_validator.py
import re

class PasswordValidator:
    def __init__(self):
        self.min_length = 8

    def validate(self, password):
        """éªŒè¯å¯†ç æ˜¯å¦ç¬¦åˆè¦æ±‚"""
        if len(password) < self.min_length:
            return False
        if not re.search(r'[A-Z]', password):
            return False
        if not re.search(r'[a-z]', password):
            return False
        if not re.search(r'\d', password):
            return False
        if not re.search(r'[!@#$%^&*(),.?":{}|<>]', password):
            return False
        return True

    def get_errors(self, password):
        """è·å–å¯†ç éªŒè¯çš„é”™è¯¯ä¿¡æ¯"""
        errors = []

        if len(password) < self.min_length:
            errors.append("å¯†ç é•¿åº¦è‡³å°‘8ä½")
        if not re.search(r'[A-Z]', password):
            errors.append("å¿…é¡»åŒ…å«å¤§å†™å­—æ¯")
        if not re.search(r'[a-z]', password):
            errors.append("å¿…é¡»åŒ…å«å°å†™å­—æ¯")
        if not re.search(r'\d', password):
            errors.append("å¿…é¡»åŒ…å«æ•°å­—")
        if not re.search(r'[!@#$%^&*(),.?":{}|<>]', password):
            errors.append("å¿…é¡»åŒ…å«ç‰¹æ®Šå­—ç¬¦")

        return errors
```

**4. è¿è¡Œæµ‹è¯•ï¼ˆé€šè¿‡ï¼‰**ï¼š
```bash
pytest test_password_validator.py
# ç°åœ¨åº”è¯¥å…¨éƒ¨é€šè¿‡
```

**5. é‡æ„ï¼ˆä¼˜åŒ–ï¼‰**ï¼š
```python
# é‡æ„åçš„å¯†ç éªŒè¯å™¨
class PasswordValidator:
    def __init__(self, min_length=8):
        self.min_length = min_length
        self.patterns = {
            'uppercase': r'[A-Z]',
            'lowercase': r'[a-z]',
            'number': r'\d',
            'special': r'[!@#$%^&*(),.?":{}|<>]'
        }
        self.error_messages = {
            'length': f"å¯†ç é•¿åº¦è‡³å°‘{min_length}ä½",
            'uppercase': "å¿…é¡»åŒ…å«å¤§å†™å­—æ¯",
            'lowercase': "å¿…é¡»åŒ…å«å°å†™å­—æ¯",
            'number': "å¿…é¡»åŒ…å«æ•°å­—",
            'special': "å¿…é¡»åŒ…å«ç‰¹æ®Šå­—ç¬¦"
        }

    def validate(self, password):
        """éªŒè¯å¯†ç æ˜¯å¦ç¬¦åˆè¦æ±‚"""
        return len(self.get_errors(password)) == 0

    def get_errors(self, password):
        """è·å–å¯†ç éªŒè¯çš„é”™è¯¯ä¿¡æ¯"""
        errors = []

        if len(password) < self.min_length:
            errors.append(self.error_messages['length'])

        for name, pattern in self.patterns.items():
            if not re.search(pattern, password):
                errors.append(self.error_messages[name])

        return errors
```

**6. å†æ¬¡è¿è¡Œæµ‹è¯•ï¼ˆç¡®ä¿é‡æ„æ²¡æœ‰ç ´ååŠŸèƒ½ï¼‰**ï¼š
```bash
pytest test_password_validator.py -v
```

#### 4.3ã€è¦†ç›–ç‡æµ‹è¯•

**å®‰è£…coverageå·¥å…·**ï¼š
```bash
pip install pytest-cov
```

**è¦†ç›–ç‡æŠ¥å‘Š**ï¼š
```bash
# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=calculator test_calculator.py

# ç”ŸæˆHTMLæŠ¥å‘Š
pytest --cov=calculator --cov-report=html test_calculator.py

# æŸ¥çœ‹HTMLæŠ¥å‘Š
open htmlcov/index.html

# è®¾ç½®è¦†ç›–ç‡é˜ˆå€¼
pytest --cov=calculator --cov-fail-under=80 test_calculator.py
```

**è¦†ç›–ç‡é…ç½® `.coveragerc`**ï¼š
```ini
[run]
source = src
omit =
    tests/*
    venv/*
    */migrations/*

[report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:

[html]
directory = htmlcov
```

#### 4.4ã€mockä½¿ç”¨

mockç”¨äºéš”ç¦»ä¾èµ–ï¼Œç±»ä¼¼äºJavaçš„Mockitoã€‚

**åŸºæœ¬mockä½¿ç”¨**ï¼š
```python
# user_service.py
import requests

class UserService:
    def __init__(self, api_base_url):
        self.api_base_url = api_base_url

    def get_user(self, user_id):
        """ä»APIè·å–ç”¨æˆ·ä¿¡æ¯"""
        response = requests.get(f"{self.api_base_url}/users/{user_id}")
        if response.status_code == 200:
            return response.json()
        return None

    def send_welcome_email(self, user_email):
        """å‘é€æ¬¢è¿é‚®ä»¶"""
        # å‡è®¾è¿™æ˜¯è°ƒç”¨é‚®ä»¶æœåŠ¡
        response = requests.post(
            "https://api.emailservice.com/send",
            json={"to": user_email, "subject": "Welcome!"}
        )
        return response.status_code == 200
```

```python
# test_user_service.py
import pytest
from unittest.mock import Mock, patch
from user_service import UserService

class TestUserService:
    def setup_method(self):
        self.service = UserService("https://api.example.com")

    @patch('user_service.requests.get')
    def test_get_user_success(self, mock_get):
        """æµ‹è¯•æˆåŠŸè·å–ç”¨æˆ·"""
        # æ¨¡æ‹ŸAPIå“åº”
        mock_response = Mock()
        mock_response.status_code = 200
        mock_response.json.return_value = {
            "id": 1,
            "name": "å¼ ä¸‰",
            "email": "zhangsan@example.com"
        }
        mock_get.return_value = mock_response

        # æµ‹è¯•
        user = self.service.get_user(1)

        # éªŒè¯
        assert user is not None
        assert user["name"] == "å¼ ä¸‰"
        mock_get.assert_called_once_with("https://api.example.com/users/1")

    @patch('user_service.requests.get')
    def test_get_user_not_found(self, mock_get):
        """æµ‹è¯•ç”¨æˆ·ä¸å­˜åœ¨"""
        mock_response = Mock()
        mock_response.status_code = 404
        mock_get.return_value = mock_response

        user = self.service.get_user(999)
        assert user is None

    @patch('user_service.requests.post')
    def test_send_welcome_email(self, mock_post):
        """æµ‹è¯•å‘é€æ¬¢è¿é‚®ä»¶"""
        mock_response = Mock()
        mock_response.status_code = 200
        mock_post.return_value = mock_response

        result = self.service.send_welcome_email("test@example.com")
        assert result is True

        # éªŒè¯è°ƒç”¨å‚æ•°
        mock_post.assert_called_once_with(
            "https://api.emailservice.com/send",
            json={"to": "test@example.com", "subject": "Welcome!"}
        )
```

**é«˜çº§mockæŠ€å·§**ï¼š
```python
# test_advanced_mock.py
from unittest.mock import Mock, patch, MagicMock
import pytest

class TestAdvancedMock:
    def test_mock_side_effect(self):
        """ä½¿ç”¨side_effectæ¨¡æ‹Ÿä¸åŒæƒ…å†µ"""
        mock_func = Mock()
        mock_func.side_effect = [200, 404, 500]  # è¿ç»­è°ƒç”¨çš„ä¸åŒè¿”å›å€¼

        assert mock_func() == 200
        assert mock_func() == 404
        assert mock_func() == 500

    def test_mock_exception(self):
        """æ¨¡æ‹Ÿå¼‚å¸¸"""
        mock_func = Mock()
        mock_func.side_effect = ValueError("APIé”™è¯¯")

        with pytest.raises(ValueError, match="APIé”™è¯¯"):
            mock_func()

    @patch('builtins.open', new_callable=MagicMock)
    def test_file_operations(self, mock_open):
        """æµ‹è¯•æ–‡ä»¶æ“ä½œ"""
        mock_file = MagicMock()
        mock_file.__enter__.return_value = mock_file
        mock_file.read.return_value = "file content"
        mock_open.return_value = mock_file

        # æµ‹è¯•ä»£ç 
        with open("test.txt", "r") as f:
            content = f.read()

        assert content == "file content"
        mock_open.assert_called_once_with("test.txt", "r")

    def test_mock_spec(self):
        """ä½¿ç”¨specæ¨¡æ‹Ÿç‰¹å®šæ¥å£"""
        class DatabaseInterface:
            def get_user(self, user_id): pass
            def save_user(self, user): pass

        mock_db = Mock(spec=DatabaseInterface)

        # æ­£ç¡®çš„æ–¹æ³•è°ƒç”¨
        mock_db.get_user(1)

        # é”™è¯¯çš„æ–¹æ³•è°ƒç”¨ä¼šå¼•å‘å¼‚å¸¸
        # mock_db.delete_user(1)  # ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ¥å£ä¸­æ²¡æœ‰è¿™ä¸ªæ–¹æ³•

        mock_db.get_user.assert_called_once_with(1)
```

**pytest fixtures**ï¼š
```python
# conftest.py
import pytest
from unittest.mock import Mock

@pytest.fixture
def mock_api_client():
    """åˆ›å»ºæ¨¡æ‹ŸAPIå®¢æˆ·ç«¯"""
    client = Mock()
    client.get_user.return_value = {"id": 1, "name": "æµ‹è¯•ç”¨æˆ·"}
    client.create_user.return_value = {"id": 2, "name": "æ–°ç”¨æˆ·"}
    return client

@pytest.fixture
def user_service(mock_api_client):
    """ä½¿ç”¨æ¨¡æ‹ŸAPIå®¢æˆ·ç«¯åˆ›å»ºç”¨æˆ·æœåŠ¡"""
    from user_service import UserService
    return UserService(mock_api_client)

# test_with_fixtures.py
def test_user_service_with_fixture(user_service, mock_api_client):
    """ä½¿ç”¨fixtureçš„æµ‹è¯•"""
    user = user_service.get_user(1)
    assert user["name"] == "æµ‹è¯•ç”¨æˆ·"
    mock_api_client.get_user.assert_called_once_with(1)
```

**å¼‚æ­¥æµ‹è¯•**ï¼š
```python
# test_async.py
import pytest
from unittest.mock import AsyncMock, patch

@pytest.mark.asyncio
async def test_async_function():
    """æµ‹è¯•å¼‚æ­¥å‡½æ•°"""
    async_func = AsyncMock()
    async_func.return_value = "async result"

    result = await async_func()
    assert result == "async result"

@patch('aiohttp.ClientSession.get')
@pytest.mark.asyncio
async def test_async_api_call(self, mock_get):
    """æµ‹è¯•å¼‚æ­¥APIè°ƒç”¨"""
    mock_response = AsyncMock()
    mock_response.status_code = 200
    mock_response.json.return_value = {"data": "test"}
    mock_get.return_value.__aenter__.return_value = mock_response

    async with aiohttp.ClientSession() as session:
        response = await session.get("https://api.example.com/data")
        data = await response.json()

    assert data["data"] == "test"
```

### 5ã€æ€§èƒ½ä¼˜åŒ–

Pythonçš„æ€§èƒ½ä¼˜åŒ–ä¸Javaæœ‰å¾ˆå¤§ä¸åŒã€‚Pythonæ˜¯è§£é‡Šå‹è¯­è¨€ï¼Œéœ€è¦é‡‡ç”¨ä¸åŒçš„ä¼˜åŒ–ç­–ç•¥ã€‚

#### 5.1ã€timeitæ€§èƒ½æµ‹è¯•

**åŸºæœ¬timeitä½¿ç”¨**ï¼š
```python
import timeit

# æµ‹è¯•å°ä»£ç ç‰‡æ®µçš„æ‰§è¡Œæ—¶é—´
def test_list_comprehension():
    return [x**2 for x in range(1000)]

def test_for_loop():
    result = []
    for x in range(1000):
        result.append(x**2)
    return result

# timeitæµ‹è¯•
list_comp_time = timeit.timeit(test_list_comprehension, number=1000)
for_loop_time = timeit.timeit(test_for_loop, number=1000)

print(f"åˆ—è¡¨æ¨å¯¼å¼: {list_comp_time:.6f}ç§’")
print(f"forå¾ªç¯: {for_loop_time:.6f}ç§’")
print(f"æ€§èƒ½æå‡: {for_loop_time/list_comp_time:.2f}å€")

# ä½¿ç”¨timeit.repeatè¿›è¡Œå¤šæ¬¡æµ‹è¯•
times = timeit.repeat(test_list_comprehension, number=1000, repeat=5)
print(f"å„æ¬¡æ‰§è¡Œæ—¶é—´: {[f'{t:.6f}' for t in times]}")
```

**å‘½ä»¤è¡Œtimeit**ï¼š
```bash
python -m timeit "[x**2 for x in range(1000)]"
python -m timeit -n 1000 "sum(range(100))"
python -m timeit -s "import math" "math.sqrt(144)"
```

**æ€§èƒ½å¯¹æ¯”ç¤ºä¾‹**ï¼š
```python
import timeit

def compare_string_concatenation():
    """æ¯”è¾ƒå­—ç¬¦ä¸²æ‹¼æ¥æ–¹æ³•çš„æ€§èƒ½"""
    def method1_plus():
        result = ""
        for i in range(1000):
            result += str(i)
        return result

    def method2_join():
        return "".join(str(i) for i in range(1000))

    def method3_f_string():
        parts = [str(i) for i in range(1000)]
        return "".join(parts)

    # æµ‹è¯•
    time1 = timeit.timeit(method1_plus, number=100)
    time2 = timeit.timeit(method2_join, number=100)
    time3 = timeit.timeit(method3_f_string, number=100)

    print(f"å­—ç¬¦ä¸²æ‹¼æ¥ (+): {time1:.6f}ç§’")
    print(f"å­—ç¬¦ä¸²æ‹¼æ¥ (join): {time2:.6f}ç§’")
    print(f"åˆ—è¡¨æ‹¼æ¥ (f-string): {time3:.6f}ç§’")
    print(f"joinæ¯”+å¿« {time1/time2:.2f}å€")

compare_string_concatenation()
```

#### 5.2ã€cProfileæ€§èƒ½åˆ†æ

**ä½¿ç”¨cProfile**ï¼š
```python
import cProfile
import pstats
import io

def slow_function():
    """æ¨¡æ‹Ÿæ…¢å‡½æ•°"""
    total = 0
    for i in range(1000000):
        total += i ** 2
    return total

def another_function():
    """å¦ä¸€ä¸ªå‡½æ•°"""
    result = []
    for i in range(100000):
        result.append(i * 2)
    return sum(result)

def main_function():
    """ä¸»å‡½æ•°"""
    result1 = slow_function()
    result2 = another_function()
    return result1 + result2

# åˆ›å»ºProfileå¯¹è±¡
profiler = cProfile.Profile()

# å¼€å§‹åˆ†æ
profiler.enable()

# æ‰§è¡Œä»£ç 
main_function()

# åœæ­¢åˆ†æ
profiler.disable()

# è¾“å‡ºç»“æœ
# æ–¹æ³•1ï¼šç›´æ¥æ‰“å°åˆ°æ§åˆ¶å°
profiler.print_stats(sort='cumulative')

# æ–¹æ³•2ï¼šä¿å­˜åˆ°å­—ç¬¦ä¸²
s = io.StringIO()
ps = pstats.Stats(profiler, stream=s).sort_stats('cumulative')
ps.print_stats()
print(s.getvalue())

# æ–¹æ³•3ï¼šä¿å­˜åˆ°æ–‡ä»¶
profiler.dump_stats('profile_results.prof')
```

**å‘½ä»¤è¡ŒcProfile**ï¼š
```bash
# åˆ†æPythonè„šæœ¬
python -m cProfile -s cumulative myscript.py

# æŒ‰å‡½æ•°åæ’åº
python -m cProfile -s name myscript.py

# ä¿å­˜åˆ†æç»“æœ
python -m cProfile -o profile_output.prof myscript.py

# æŸ¥çœ‹åˆ†æç»“æœ
python -c "import pstats; pstats.Stats('profile_output.prof').sort_stats('cumulative').print_stats(20)"
```

**åˆ†æç»“æœè§£è¯»**ï¼š
```
   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001    0.150    0.150 myscript.py:25(main_function)
        1    0.080    0.080    0.080    0.080 myscript.py:15(slow_function)
        1    0.069    0.069    0.069    0.069 myscript.py:20(another_function)
```

- `ncalls`: è°ƒç”¨æ¬¡æ•°
- `tottime`: å‡½æ•°è‡ªèº«æ‰§è¡Œæ—¶é—´ï¼ˆä¸åŒ…æ‹¬å­å‡½æ•°ï¼‰
- `percall`: å¹³å‡æ¯æ¬¡è°ƒç”¨æ—¶é—´
- `cumtime`: ç´¯è®¡æ‰§è¡Œæ—¶é—´ï¼ˆåŒ…æ‹¬å­å‡½æ•°ï¼‰

**é«˜çº§æ€§èƒ½åˆ†æ**ï¼š
```python
import cProfile
import pstats
from functools import wraps

def profile_function(func):
    """æ€§èƒ½åˆ†æè£…é¥°å™¨"""
    @wraps(func)
    def wrapper(*args, **kwargs):
        profiler = cProfile.Profile()
        profiler.enable()

        result = func(*args, **kwargs)

        profiler.disable()

        # åˆ›å»ºç»Ÿè®¡å¯¹è±¡
        stats = pstats.Stats(profiler)
        stats.sort_stats('cumulative')
        print(f"\n=== æ€§èƒ½åˆ†æç»“æœ: {func.__name__} ===")
        stats.print_stats(10)  # æ˜¾ç¤ºå‰10ä¸ªæœ€è€—æ—¶çš„å‡½æ•°

        return result
    return wrapper

@profile_function
def fibonacci(n):
    """è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆéä¼˜åŒ–ç‰ˆæœ¬ï¼‰"""
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)

# ä½¿ç”¨
result = fibonacci(30)
print(f"ç»“æœ: {result}")
```

#### 5.3ã€å¸¸è§æ€§èƒ½é™·é˜±

**é™·é˜±1ï¼šå­—ç¬¦ä¸²æ‹¼æ¥**ï¼š
```python
# âŒ ä½æ•ˆï¼šåœ¨å¾ªç¯ä¸­ä½¿ç”¨+æ‹¼æ¥
def inefficient_concatenation(items):
    result = ""
    for item in items:
        result += str(item) + ","  # æ¯æ¬¡éƒ½åˆ›å»ºæ–°å­—ç¬¦ä¸²å¯¹è±¡
    return result

# âœ… é«˜æ•ˆï¼šä½¿ç”¨join
def efficient_concatenation(items):
    return ",".join(str(item) for item in items)

# æ€§èƒ½å¯¹æ¯”
import timeit
items = list(range(10000))
time1 = timeit.timeit(lambda: inefficient_concatenation(items), number=10)
time2 = timeit.timeit(lambda: efficient_concatenation(items), number=10)
print(f"ä½æ•ˆæ–¹æ³•: {time1:.4f}ç§’")
print(f"é«˜æ•ˆæ–¹æ³•: {time2:.4f}ç§’")
```

**é™·é˜±2ï¼šé‡å¤è®¡ç®—**ï¼š
```python
# âŒ ä½æ•ˆï¼šé‡å¤è®¡ç®—
def inefficient_sum(matrix):
    total = 0
    for row in matrix:
        for val in row:
            if len(row) > 0:  # æ¯æ¬¡éƒ½è®¡ç®—é•¿åº¦
                total += val
    return total

# âœ… é«˜æ•ˆï¼šç¼“å­˜è®¡ç®—ç»“æœ
def efficient_sum(matrix):
    total = 0
    for row in matrix:
        row_length = len(row)  # åªè®¡ç®—ä¸€æ¬¡
        if row_length > 0:
            for val in row:
                total += val
    return total
```

**é™·é˜±3ï¼šä¸å¿…è¦çš„å‡½æ•°è°ƒç”¨**ï¼š
```python
# âŒ ä½æ•ˆï¼šé‡å¤è°ƒç”¨å‡½æ•°
def inefficient_processing(items):
    result = []
    for item in items:
        if expensive_check(item):  # å¯èƒ½é‡å¤è®¡ç®—
            result.append(process_item(item))
    return result

# âœ… é«˜æ•ˆï¼šç¼“å­˜ç»“æœ
def efficient_processing(items):
    result = []
    cache = {}
    for item in items:
        cache_key = get_cache_key(item)
        if cache_key not in cache:
            cache[cache_key] = expensive_check(item)

        if cache[cache_key]:
            result.append(process_item(item))
    return result
```

**é™·é˜±4ï¼šå…¨å±€å˜é‡è®¿é—®**ï¼š
```python
# âŒ ä½æ•ˆï¼šåœ¨å¾ªç¯ä¸­è®¿é—®å…¨å±€å˜é‡
CONFIG = {"max_items": 1000, "threshold": 0.5}

def inefficient_filter(items):
    result = []
    for item in items:
        if item.value > CONFIG["threshold"]:  # æ¯æ¬¡éƒ½è®¿é—®å…¨å±€å˜é‡
            result.append(item)
    return result

# âœ… é«˜æ•ˆï¼šç¼“å­˜åˆ°å±€éƒ¨å˜é‡
def efficient_filter(items):
    result = []
    threshold = CONFIG["threshold"]  # ç¼“å­˜åˆ°å±€éƒ¨å˜é‡
    for item in items:
        if item.value > threshold:
            result.append(item)
    return result
```

**é™·é˜±5ï¼šåˆ—è¡¨æŸ¥æ‰¾æ“ä½œ**ï¼š
```python
# âŒ ä½æ•ˆï¼šä½¿ç”¨inæ“ä½œæŸ¥æ‰¾å¤§åˆ—è¡¨
large_list = list(range(100000))
def inefficient_search(items_to_find):
    results = []
    for item in items_to_find:
        if item in large_list:  # O(n)å¤æ‚åº¦
            results.append(item)
    return results

# âœ… é«˜æ•ˆï¼šä½¿ç”¨é›†åˆ
large_set = set(large_list)
def efficient_search(items_to_find):
    results = []
    for item in items_to_find:
        if item in large_set:  # O(1)å¤æ‚åº¦
            results.append(item)
    return results
```

#### 5.4ã€ä¼˜åŒ–å»ºè®®

**1. ä½¿ç”¨å†…ç½®å‡½æ•°å’Œæ•°æ®ç»“æ„**ï¼š
```python
import numpy as np

# âœ… ä½¿ç”¨numpyè¿›è¡Œæ•°å€¼è®¡ç®—
def efficient_math_operation(data):
    arr = np.array(data)
    return np.sum(arr ** 2) / len(arr)

# âœ… ä½¿ç”¨å†…ç½®å‡½æ•°
data = [1, 2, 3, 4, 5]
sum_data = sum(data)  # æ¯”å¾ªç¯æ±‚å’Œå¿«
max_data = max(data)  # æ¯”æ‰‹åŠ¨æŸ¥æ‰¾å¿«
sorted_data = sorted(data)  # æ¯”è‡ªå®šä¹‰æ’åºå¿«
```

**2. ç”Ÿæˆå™¨å’Œè¿­ä»£å™¨**ï¼š
```python
# âœ… ä½¿ç”¨ç”Ÿæˆå™¨å¤„ç†å¤§æ•°æ®
def process_large_file(filename):
    with open(filename, 'r') as f:
        for line in f:  # é€è¡Œå¤„ç†ï¼Œä¸åŠ è½½æ•´ä¸ªæ–‡ä»¶
            yield process_line(line)

# âœ… ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼
large_list = range(1000000)
sum_result = sum(x * x for x in large_list)  # å†…å­˜é«˜æ•ˆ
```

**3. å¤šè¿›ç¨‹å’Œå¼‚æ­¥ç¼–ç¨‹**ï¼š
```python
import multiprocessing
from concurrent.futures import ProcessPoolExecutor

# âœ… CPUå¯†é›†å‹ä»»åŠ¡ä½¿ç”¨å¤šè¿›ç¨‹
def cpu_intensive_task(data):
    return sum(x ** 2 for x in data)

def parallel_processing(data_chunks):
    with ProcessPoolExecutor() as executor:
        results = list(executor.map(cpu_intensive_task, data_chunks))
    return sum(results)

# âœ… I/Oå¯†é›†å‹ä»»åŠ¡ä½¿ç”¨å¼‚æ­¥
import asyncio
import aiohttp

async def fetch_url(url):
    async with aiohttp.ClientSession() as session:
        async with session.get(url) as response:
            return await response.text()

async def fetch_multiple_urls(urls):
    tasks = [fetch_url(url) for url in urls]
    return await asyncio.gather(*tasks)
```

**4. ç¼“å­˜å’Œè®°å¿†åŒ–**ï¼š
```python
from functools import lru_cache
import functools

# âœ… ä½¿ç”¨lru_cache
@lru_cache(maxsize=128)
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)

# âœ… è‡ªå®šä¹‰ç¼“å­˜
class SimpleCache:
    def __init__(self, maxsize=100):
        self.cache = {}
        self.maxsize = maxsize

    def get(self, key):
        return self.cache.get(key)

    def set(self, key, value):
        if len(self.cache) >= self.maxsize:
            self.cache.clear()
        self.cache[key] = value

cache = SimpleCache()

def expensive_operation(x):
    cached_result = cache.get(x)
    if cached_result is not None:
        return cached_result

    result = complex_calculation(x)
    cache.set(x, result)
    return result
```

**5. ä½¿ç”¨Cæ‰©å±•**ï¼š
```python
# âœ… å¯¹äºæ€§èƒ½å…³é”®éƒ¨åˆ†ï¼Œè€ƒè™‘ä½¿ç”¨Cythonæˆ–Cæ‰©å±•
# æˆ–è€…ä½¿ç”¨å·²æœ‰çš„é«˜æ€§èƒ½åº“å¦‚numpyã€pandasã€scipyç­‰

import numpy as np

# numpyçš„å®ç°æ¯”çº¯Pythonå¿«å¾ˆå¤šå€
def fast_vector_operation(arr1, arr2):
    return np.dot(arr1, arr2)  # ä½¿ç”¨ä¼˜åŒ–çš„BLASåº“
```

**æ€§èƒ½ç›‘æ§å·¥å…·**ï¼š
```python
import time
import tracemalloc
from contextlib import contextmanager

@contextmanager
def performance_monitor():
    """æ€§èƒ½ç›‘æ§ä¸Šä¸‹æ–‡ç®¡ç†å™¨"""
    # å¼€å§‹å†…å­˜è·Ÿè¸ª
    tracemalloc.start()
    start_time = time.time()

    try:
        yield
    finally:
        # ç»“æŸè®¡æ—¶
        end_time = time.time()
        current, peak = tracemalloc.get_traced_memory()
        tracemalloc.stop()

        print(f"æ‰§è¡Œæ—¶é—´: {end_time - start_time:.4f}ç§’")
        print(f"å½“å‰å†…å­˜ä½¿ç”¨: {current / 1024 / 1024:.2f} MB")
        print(f"å³°å€¼å†…å­˜ä½¿ç”¨: {peak / 1024 / 1024:.2f} MB")

# ä½¿ç”¨ç¤ºä¾‹
with performance_monitor():
    # æ‰§è¡Œéœ€è¦ç›‘æ§çš„ä»£ç 
    result = some_expensive_operation()
```

## ä¸‰ã€æ€»ç»“ä¸å±•æœ›

### 1ã€Pythonä¸Javaçš„å„è‡ªä¼˜åŠ¿

#### 1.1ã€ğŸ”¸ Pythonçš„æ ¸å¿ƒä¼˜åŠ¿

```python
# 1. ç®€æ´ä¼˜é›…çš„è¯­æ³•
def calculate_total(items):
    return sum(item.price for item in items if item.available)

# 2. åŠ¨æ€ç±»å‹å¸¦æ¥çš„çµæ´»æ€§
data = {"name": "å¼ ä¸‰", "age": 30, "skills": ["Python", "Java"]}
data["email"] = "zhangsan@example.com"  # åŠ¨æ€æ·»åŠ å±æ€§

# 3. å¼ºå¤§çš„æ ‡å‡†åº“å’Œç”Ÿæ€
import pandas as pd
import requests
import numpy as np
import matplotlib.pyplot as plt

# ä¸€è¡Œä»£ç å®Œæˆå¤æ‚æ“ä½œ
df = pd.read_csv('data.csv').groupby('category').sum()
```

**ğŸ“Š Pythonä¼˜åŠ¿å¯¹æ¯”è¡¨**

| ç‰¹æ€§ | Python | Java | é€‚ç”¨åœºæ™¯ |
|------|--------|------|----------|
| **å­¦ä¹ æ›²çº¿** | å¹³ç¼“ï¼Œè¯­æ³•ç®€æ´ | è¾ƒé™¡ï¼Œæ¦‚å¿µå¤æ‚ | å¿«é€Ÿå…¥é—¨ï¼ŒåŸå‹å¼€å‘ |
| **å¼€å‘æ•ˆç‡** | æé«˜ï¼Œä»£ç é‡å°‘ | ä¸­ç­‰ï¼Œéœ€è¦è¾ƒå¤šæ¨¡æ¿ä»£ç  | MVPå¼€å‘ï¼Œæ•°æ®åˆ†æ |
| **ç”Ÿæ€ä¸°å¯Œåº¦** | æ•°æ®ç§‘å­¦ã€AIé¢†åŸŸé¢†å…ˆ | ä¼ä¸šçº§åº”ç”¨ç”Ÿæ€å®Œå–„ | æœºå™¨å­¦ä¹ ï¼ŒWebå¼€å‘ |
| **æ€§èƒ½** | è§£é‡Šæ‰§è¡Œï¼Œç›¸å¯¹è¾ƒæ…¢ | JITç¼–è¯‘ï¼Œæ€§èƒ½ä¼˜ç§€ | å¯¹æ€§èƒ½è¦æ±‚æé«˜çš„åœºæ™¯ |
| **éƒ¨ç½²** | ç®€å•ï¼Œæ— éœ€ç¼–è¯‘ | å¤æ‚ï¼Œéœ€è¦æ‰“åŒ…éƒ¨ç½² | å¿«é€Ÿè¿­ä»£ï¼Œäº‘åŸç”Ÿ |

#### 1.2ã€ğŸ”¸ Javaçš„æ ¸å¿ƒä¼˜åŠ¿

```java
// 1. å¼ºç±»å‹ç³»ç»Ÿï¼Œç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥
public class UserService {
    private final UserRepository userRepository;

    public UserService(UserRepository userRepository) {
        this.userRepository = Objects.requireNonNull(userRepository);
    }

    // ç¼–è¯‘å™¨ä¼šæ£€æŸ¥ç±»å‹é”™è¯¯
    public User findUserById(Long userId) {
        return userRepository.findById(userId)
                .orElseThrow(() -> new UserNotFoundException(userId));
    }
}

// 2. é¢å‘å¯¹è±¡çš„å®Œå¤‡æ”¯æŒ
public abstract class Animal {
    protected String name;

    public abstract void makeSound();

    public void sleep() {
        System.out.println(name + " is sleeping");
    }
}

// 3. æˆç†Ÿçš„ä¼ä¸šçº§ç”Ÿæ€
@Service
@Transactional
public class OrderService {
    @Autowired
    private OrderRepository orderRepository;

    public Order createOrder(OrderRequest request) {
        // ä¼ä¸šçº§äº‹åŠ¡ç®¡ç†
        Order order = new Order(request);
        return orderRepository.save(order);
    }
}
```

**ğŸ¢ Javaåœ¨ä»¥ä¸‹åœºæ™¯ä¸­æ›´å…·ä¼˜åŠ¿ï¼š**

1. **å¤§å‹ä¼ä¸šçº§åº”ç”¨**ï¼šé“¶è¡Œã€ä¿é™©ã€ç”µä¿¡ç­‰æ ¸å¿ƒä¸šåŠ¡ç³»ç»Ÿ
2. **é«˜æ€§èƒ½è¦æ±‚**ï¼šäº¤æ˜“ç³»ç»Ÿã€å®æ—¶æ•°æ®å¤„ç†
3. **å›¢é˜Ÿåä½œå¼€å‘**ï¼šå¼ºç±»å‹çº¦æŸï¼Œä¾¿äºå¤§å‹å›¢é˜Ÿåä½œ
4. **é•¿æœŸç»´æŠ¤é¡¹ç›®**ï¼šç¨³å®šæ€§å¥½ï¼Œå‘åå…¼å®¹æ€§å¼º

### 2ã€ç»™Javaå¼€å‘è€…çš„Pythonå­¦ä¹ å¯„è¯­

ç»è¿‡å‰é¢ç³»ç»Ÿå­¦ä¹ ï¼Œç›¸ä¿¡ä½ å·²ç»å¯¹Pythonæœ‰äº†å…¨é¢çš„è®¤è¯†ã€‚ä½œä¸ºæœ‰JavaèƒŒæ™¯çš„å¼€å‘è€…ï¼Œä½ åœ¨å­¦ä¹ Pythonæ—¶å…·æœ‰ç‹¬ç‰¹çš„ä¼˜åŠ¿ï¼š

** ä½ çš„ä¼˜åŠ¿ï¼š**
1. **æ‰å®çš„ç¼–ç¨‹åŸºç¡€**ï¼šé¢å‘å¯¹è±¡æ€ç»´ã€è®¾è®¡æ¨¡å¼ã€ç®—æ³•æ•°æ®ç»“æ„
2. **å·¥ç¨‹åŒ–ç»éªŒ**ï¼šç‰ˆæœ¬æ§åˆ¶ã€æµ‹è¯•é©±åŠ¨ã€é¡¹ç›®ç®¡ç†
3. **ç³»ç»Ÿè®¾è®¡èƒ½åŠ›**ï¼šæ¶æ„æ€ç»´ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨è€ƒè™‘
4. **é—®é¢˜è§£å†³èƒ½åŠ›**ï¼šè°ƒè¯•æŠ€å·§ã€é”™è¯¯æ’æŸ¥ã€é€»è¾‘æ€ç»´

** å­¦ä¹ å»ºè®®ï¼š**
1. **ä¿æŒå¼€æ”¾å¿ƒæ€**ï¼šæ¥å—Pythonçš„åŠ¨æ€ç‰¹æ€§å’Œç®€æ´å“²å­¦
2. **åŠ¨æ‰‹å®è·µ**ï¼šå¤šå†™ä»£ç ï¼Œå¤šåšé¡¹ç›®ï¼Œåœ¨å®è·µä¸­æŒæ¡ç²¾é«“
3. **å¯¹æ¯”å­¦ä¹ **ï¼šå°†Pythonæ¦‚å¿µä¸Javaå¯¹æ¯”ï¼ŒåŠ æ·±ç†è§£
4. **å‚ä¸ç¤¾åŒº**ï¼šåŠ å…¥Pythonç¤¾åŒºï¼Œä¸å…¶ä»–å¼€å‘è€…äº¤æµç»éªŒ

** æœªæ¥å¯æœŸï¼š**
æŒæ¡Pythonå°†ä¸ºä½ æ‰“å¼€æ–°çš„å¤§é—¨ï¼š
- **æ•°æ®ç§‘å­¦ä¸AI**ï¼šè¿›å…¥äººå·¥æ™ºèƒ½é¢†åŸŸ
- **Webå¼€å‘**ï¼šå¿«é€Ÿæ„å»ºç°ä»£Webåº”ç”¨
- **è‡ªåŠ¨åŒ–è¿ç»´**ï¼šæå‡å·¥ä½œæ•ˆç‡
- **å…¨æ ˆå¼€å‘**ï¼šå‰åç«¯é€šåƒï¼Œæˆä¸ºå¤åˆå‹äººæ‰

** æœ€åçš„è¯ï¼š**
ç¼–ç¨‹è¯­è¨€åªæ˜¯å·¥å…·ï¼Œè§£å†³é—®é¢˜çš„æ€ç»´å’Œèƒ½åŠ›æ‰æ˜¯æ ¸å¿ƒç«äº‰åŠ›ã€‚Javaç»™äº†ä½ åšå®çš„åŸºç¡€ï¼ŒPythonå°†ç»™ä½ æ’ä¸Šçµæ´»çš„ç¿…è†€ã€‚ä¿æŒå­¦ä¹ çš„çƒ­æƒ…ï¼Œæ‹¥æŠ±æŠ€æœ¯çš„å˜åŒ–ï¼Œä½ å°†åœ¨ç¼–ç¨‹çš„é“è·¯ä¸Šèµ°å¾—æ›´è¿œï¼


**ç¥ä½ å˜å¾—æ›´å¼º!**
